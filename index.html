<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pyramakerz â€” Operation System</title>

  <!-- ======================================================
       Ù…ÙƒØªØ¨Ø© Supabase â€” Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
       ====================================================== -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>

    /* ======================================================
       1. DESIGN TOKENS â€” Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø£Ù„ÙˆØ§Ù†
       ====================================================== */
    :root {
      /* Ø£Ù„ÙˆØ§Ù† Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ© */
      --or:   #F97316;   /* Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
      --ord:  #EA580C;   /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø¯Ø§ÙƒÙ† Ù„Ù„Ù€ hover */
      --orb:  #FFF7ED;   /* Ø®Ù„ÙÙŠØ© Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØ© ÙØ§ØªØ­Ø© */
      --orbd: #FED7AA;   /* Ø­Ø¯ÙˆØ¯ Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØ© */

      /* Ø±Ù…Ø§Ø¯ÙŠ Ù…ØªØ¯Ø±Ø¬ */
      --g50:  #F9FAFB;
      --g100: #F3F4F6;
      --g200: #E5E7EB;
      --g300: #D1D5DB;   /* âœ… ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ â€” ÙƒØ§Ù† Ù…Ø³ØªØ®Ø¯Ù…Ø§Ù‹ ÙÙŠ btn.secondary */
      --g400: #9CA3AF;
      --g600: #4B5563;
      --g800: #1F2937;
      --g900: #111827;
    }

    /* ======================================================
       2. RESET â€” Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù€ margin ÙˆØ§Ù„Ù€ padding Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
       ====================================================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Tahoma', sans-serif;
      background: var(--g50);
      color: var(--g900);
      direction: rtl;
      min-height: 100vh;
    }

    /* ======================================================
       3. LOGIN SCREEN â€” Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
       ====================================================== */
    #login-screen {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: linear-gradient(135deg, #fff7ed, #fff, #fff7ed);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ */
    .lcard {
      background: #fff;
      border-radius: 24px;
      padding: 48px 44px 40px;
      width: 380px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(249,115,22,.15);
      border: 1px solid var(--orbd);
    }

    .llogo  { width: 180px; margin: 0 auto 20px; display: block; cursor: pointer; }
    .ldiv   { width: 36px; height: 3px; background: var(--or); border-radius: 2px; margin: 0 auto 18px; }
    .ltitle { font-size: 12px; font-weight: 700; color: var(--g600); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 24px; }

    /* Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± */
    .linput {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid var(--g200);
      border-radius: 10px;
      font-family: inherit;
      font-size: 15px;
      text-align: center;
      letter-spacing: 4px;
      outline: none;
      transition: border .2s;
      margin-bottom: 12px;
    }
    .linput:focus { border-color: var(--or); }

    /* Ø²Ø±Ø§Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ */
    .lbtn { width: 100%; padding: 12px; background: var(--or); color: #fff; border: none; border-radius: 10px; font-family: inherit; font-size: 14px; font-weight: 700; cursor: pointer; transition: all .2s; }
    .lbtn:hover { background: var(--ord); }

    /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ */
    .lerr { color: #ef4444; font-size: 12px; margin-top: 8px; display: none; }

    /* ======================================================
       4. APP WRAPPER â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
       ====================================================== */
    #app { display: none; }

    /* ======================================================
       5. TOPBAR â€” Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ø«Ø§Ø¨Øª
       ====================================================== */
    .topbar {
      background: #fff;
      border-bottom: 2px solid var(--orbd);
      padding: 0 32px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(249,115,22,.07);
    }

    .tb-logo  { display: flex; align-items: center; gap: 12px; cursor: pointer; }
    .tb-logo img { height: 34px; }
    .tb-sep   { width: 1px; height: 26px; background: var(--orbd); }
    .tb-title { font-size: 13px; font-weight: 700; color: var(--g800); letter-spacing: 1px; }
    .tb-right { display: flex; align-items: center; gap: 8px; }

    /* Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ â€” Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .tb-back      { display: none; align-items: center; gap: 5px; padding: 6px 14px; background: var(--orb); border: 1px solid var(--orbd); border-radius: 8px; color: var(--ord); font-size: 13px; font-weight: 600; cursor: pointer; transition: all .15s; }
    .tb-back.show { display: flex; }
    .tb-back:hover { background: var(--orbd); }

    /* Ù…Ø¤Ø´Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø£Ø®Ø¶Ø± Ø§Ù„Ù…ØªÙ†ÙØ³ */
    .sdot { width: 7px; height: 7px; border-radius: 50%; background: #10b981; animation: pulse 2s infinite; display: inline-block; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .4; } }
    .slbl { color: var(--g400); font-size: 11px; }

    /* Ù†Ø®ÙÙŠ Ø§Ù„Ù€ breadcrumb Ù„Ø£Ù†Ù†Ø§ Ø¨Ù†Ø³ØªØ®Ø¯Ù… Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙ‚Ø· */
    .bc { display: none !important; }

    /* ======================================================
       6. ACTION MENU â€” Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ 3 Ù†Ù‚Ø§Ø· (â‹®) ÙÙŠ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
       ====================================================== */
    .act-wrap { position: relative; display: inline-block; }

    .act-btn { background: none; border: none; cursor: pointer; font-size: 18px; color: var(--g400); padding: 2px 6px; border-radius: 5px; line-height: 1; transition: all .15s; }
    .act-btn:hover { background: var(--g100); color: var(--g800); }

    /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© */
    .act-menu          { display: none; position: absolute; left: 0; top: 100%; background: #fff; border: 1px solid var(--g200); border-radius: 10px; box-shadow: 0 8px 24px rgba(0,0,0,.12); min-width: 130px; z-index: 200; overflow: hidden; }
    .act-menu.open     { display: block; }
    .act-menu button   { display: flex; align-items: center; gap: 7px; width: 100%; padding: 9px 14px; border: none; background: none; font-family: inherit; font-size: 12.5px; font-weight: 600; cursor: pointer; text-align: right; color: var(--g800); transition: background .12s; }
    .act-menu button:hover { background: var(--g100); }
    .act-menu button.danger       { color: #ef4444; }
    .act-menu button.danger:hover { background: #fef2f2; }
    .act-menu button:not(:last-child) { border-bottom: 1px solid var(--g100); }

    /* ======================================================
       7. QTY COUNTER â€” Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒÙ…ÙŠØ© (+ Ùˆ âˆ’)
       ====================================================== */
    .qctr        { display: inline-flex; align-items: center; border: 2px solid var(--g200); border-radius: 8px; overflow: hidden; background: #fff; }
    .qctr button { background: none; border: none; padding: 4px 9px; font-size: 15px; font-weight: 700; color: var(--g600); cursor: pointer; transition: all .12s; line-height: 1; }
    .qctr button:hover { background: var(--orb); color: var(--or); }
    .qctr span   { min-width: 32px; text-align: center; font-size: 13px; font-weight: 800; color: var(--g900); padding: 4px 2px; }

    /* ======================================================
       8. LOADING OVERLAY â€” Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
       ====================================================== */
    .loader    { position: fixed; inset: 0; background: rgba(255,255,255,.88); z-index: 500; display: none; align-items: center; justify-content: center; flex-direction: column; gap: 14px; }
    .loader.on { display: flex; }
    .spin      { width: 38px; height: 38px; border: 4px solid var(--orbd); border-top-color: var(--or); border-radius: 50%; animation: spin .8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .spin-lbl  { color: var(--g600); font-size: 13px; font-weight: 600; }

    /* ======================================================
       9. PAGES â€” Ø§Ù„ØµÙØ­Ø§Øª (ÙƒÙ„Ù‡Ø§ Ù…Ø®ÙÙŠØ© Ø¥Ù„Ø§ Ø§Ù„Ù†Ø´Ø·Ø©)
       ====================================================== */
    .page        { display: none; padding: 32px; }
    .page.active { display: block; }

    /* ======================================================
       10. HOME â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
       ====================================================== */

    /* Ø§Ù„Ù€ hero banner Ø§Ù„Ø¹Ù„ÙˆÙŠ */
    .hero        { background: linear-gradient(135deg, var(--or), var(--ord)); border-radius: 18px; padding: 40px 44px; margin-bottom: 32px; position: relative; overflow: hidden; color: #fff; }
    .hero::before { content: ''; position: absolute; top: -50px; right: -30px; width: 220px; height: 220px; background: rgba(255,255,255,.08); border-radius: 50%; }
    .hero::after  { content: ''; position: absolute; bottom: -70px; left: 70px; width: 270px; height: 270px; background: rgba(0,0,0,.06); border-radius: 50%; }
    .hero-in { position: relative; z-index: 2; }
    .htag    { font-size: 10px; font-weight: 700; letter-spacing: 3px; text-transform: uppercase; opacity: .7; margin-bottom: 8px; }
    .htitle  { font-size: 36px; font-weight: 800; line-height: 1.1; }
    .hsub    { font-size: 13px; opacity: .75; margin-top: 8px; }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„ÙƒØ±ÙˆØª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .cgrid { display: grid; grid-template-columns: repeat(2,1fr); gap: 20px; }

    /* ÙƒØ±Øª Ø§Ù„Ù‚Ø³Ù… */
    .mcard { background: #fff; border-radius: 18px; padding: 32px 28px; cursor: pointer; border: 2px solid var(--g200); transition: all .25s cubic-bezier(.34,1.56,.64,1); position: relative; overflow: hidden; }
    .mcard:hover { border-color: var(--or); transform: translateY(-5px); box-shadow: 0 18px 36px rgba(249,115,22,.14); }
    .mcard:hover .carrow { background: var(--or); color: #fff; transform: rotate(-45deg); }
    .mcard:hover .cicon  { transform: scale(1.1); }

    /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙƒØ±Øª */
    .cicon { width: 56px; height: 56px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 26px; margin-bottom: 18px; transition: transform .2s; }
    .io { background: linear-gradient(135deg, #FFF7ED, #FED7AA); } /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
    .ib { background: linear-gradient(135deg, #EFF6FF, #BFDBFE); } /* Ø£Ø²Ø±Ù‚ */
    .ig { background: linear-gradient(135deg, #F0FDF4, #BBF7D0); } /* Ø£Ø®Ø¶Ø± */
    .ip { background: linear-gradient(135deg, #FAF5FF, #E9D5FF); } /* Ø¨Ù†ÙØ³Ø¬ÙŠ */

    .cname  { font-size: 19px; font-weight: 800; color: var(--g900); margin-bottom: 7px; }
    .cdesc  { font-size: 12px; color: var(--g400); line-height: 1.6; }
    .carrow { position: absolute; bottom: 22px; left: 22px; width: 30px; height: 30px; border-radius: 50%; background: var(--orb); display: flex; align-items: center; justify-content: center; font-size: 13px; color: var(--or); transition: all .2s; }

    /* ======================================================
       11. PAGE HEADER â€” Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© (Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø§Ù„Ø£Ø²Ø±Ø§Ø±)
       ====================================================== */
    .ph     { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 12px; }
    .ptitle { font-size: 24px; font-weight: 800; color: var(--g900); }

    /* ØªØ³Ù…ÙŠØ© Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ØµØºÙŠØ±Ø© */
    .slabel          { font-size: 11px; font-weight: 700; color: var(--g400); letter-spacing: 2px; text-transform: uppercase; display: flex; align-items: center; gap: 7px; margin-bottom: 14px; }
    .slabel::before  { content: ''; width: 4px; height: 16px; background: var(--or); border-radius: 2px; }

    /* ======================================================
       12. SCHOOLS GRID â€” Ø´Ø¨ÙƒØ© ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¯Ø§Ø±Ø³
       ====================================================== */
    .sgrid { display: grid; grid-template-columns: repeat(3,1fr); gap: 16px; }

    /* ÙƒØ±Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø© */
    .scard { background: #fff; border-radius: 14px; padding: 24px 20px; cursor: pointer; border: 2px solid var(--g200); transition: all .2s; position: relative; }
    .scard:hover { border-color: var(--or); transform: translateY(-3px); box-shadow: 0 10px 24px rgba(249,115,22,.12); }
    .sicon { font-size: 32px; margin-bottom: 12px; }
    .sname { font-size: 15px; font-weight: 800; color: var(--g900); margin-bottom: 5px; }
    .smeta { font-size: 11px; color: var(--g400); }

    /* Ø²Ø±Ø§Ø± Ø­Ø°Ù Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ã— ÙÙŠ Ø§Ù„ÙƒÙˆØ±Ù†Ø±) */
    .sdel       { position: absolute; top: 12px; left: 12px; background: none; border: none; color: var(--g200); cursor: pointer; font-size: 13px; padding: 4px; border-radius: 6px; transition: all .15s; }
    .sdel:hover { background: #fef2f2; color: #ef4444; }

    /* ======================================================
       13. TABS â€” ØªØ¨ÙˆÙŠØ¨Ø§Øª (Theme One, Theme Two, ...)
       ====================================================== */
    .ttabs { display: flex; gap: 6px; margin-bottom: 20px; border-bottom: 2px solid var(--g200); flex-wrap: wrap; }

    /* ØªØ§Ø¨ Ø¹Ø§Ø¯ÙŠ */
    .ttab             { padding: 9px 20px; background: none; border: none; border-radius: 10px 10px 0 0; font-family: inherit; font-size: 13px; font-weight: 600; color: var(--g400); cursor: pointer; transition: all .15s; border-bottom: 3px solid transparent; margin-bottom: -2px; }
    .ttab.active      { color: var(--or); border-bottom-color: var(--or); background: var(--orb); }
    .ttab:hover:not(.active) { color: var(--g800); background: var(--g100); }

    /* âœ… ØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ â€” ØªØ§Ø¨ Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© */
    .yr-tab             { padding: 9px 20px; background: none; border: none; border-radius: 10px 10px 0 0; font-family: inherit; font-size: 13px; font-weight: 600; color: var(--g400); cursor: pointer; transition: all .15s; border-bottom: 3px solid transparent; margin-bottom: -2px; }
    .yr-tab.active      { color: var(--or); border-bottom-color: var(--or); background: var(--orb); }
    .yr-tab:hover:not(.active) { color: var(--g800); background: var(--g100); }

    /* ======================================================
       14. DATA TABLES â€” Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØªÙ†Ø³ÙŠÙ‚Ù‡Ø§
       ====================================================== */
    .tcard { background: #fff; border-radius: 12px; border: 1px solid var(--g200); overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,.04); margin-bottom: 18px; }
    table  { width: 100%; border-collapse: collapse; }

    /* Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
    thead tr { background: linear-gradient(135deg, var(--ord), var(--or)); }
    thead th { padding: 12px 14px; color: #fff; font-size: 11px; font-weight: 700; text-align: right; white-space: nowrap; }
    thead th.tc { width: 120px; }       /* Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙ†Ù */
    thead th.tq { width: 75px; text-align: center; } /* Ø¹Ù…ÙˆØ¯ Ø§Ù„ÙƒÙ…ÙŠØ© */
    thead th.ta { width: 40px; text-align: center; } /* Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ */

    /* ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
    tbody tr:nth-child(even) { background: #fafafa; }
    tbody tr:nth-child(odd)  { background: #fff; }
    tbody tr:hover           { background: #FFF7ED; }
    tbody tr:last-child td   { border-bottom: none; }

    /* Ø§Ù„ØµÙ Ø§Ù„Ù…Ù‚ÙÙ„ Ù„Ø§ ÙŠØªØ£Ø«Ø± Ø¨Ø§Ù„Ù€ hover */
    tbody tr.row-locked:hover { background: inherit; }

    tbody td       { padding: 0; border-bottom: 1px solid #f3f4f6; vertical-align: top; }
    tbody td.tdc   { vertical-align: middle; padding: 9px 12px; }   /* Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙ†Ù */
    tbody td.tdq   { text-align: center; vertical-align: middle; padding: 9px 6px; }  /* Ø¹Ù…ÙˆØ¯ Ø§Ù„ÙƒÙ…ÙŠØ© */
    tbody td.tda   { text-align: center; vertical-align: middle; padding: 7px 4px; }  /* Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ */

    /* ======================================================
       15. TABLE INPUTS â€” Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
       ====================================================== */

    /* Ø­Ù‚Ù„ Ù†ØµÙŠ / textarea */
    .cedit          { width: 100%; min-height: 40px; padding: 9px 13px; font-family: inherit; font-size: 12.5px; color: var(--g800); background: transparent; border: none; outline: none; resize: none; line-height: 1.6; display: block; }
    .cedit:focus    { background: rgba(249,115,22,.04); box-shadow: inset 3px 0 0 var(--or); }
    .cedit:disabled { color: var(--g600); cursor: not-allowed; }
    .row-locked .cedit { pointer-events: none; background: transparent !important; }

    /* Ø­Ù‚Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© (Ø±Ù‚Ù… ØµØºÙŠØ±) */
    .qinput          { width: 56px; text-align: center; padding: 5px; border: 2px solid var(--g200); border-radius: 7px; font-family: inherit; font-size: 13px; font-weight: 700; color: var(--g900); outline: none; background: #fff; transition: border .15s; }
    .qinput:focus    { border-color: var(--or); }
    .qinput:disabled { background: #f3f4f6; color: var(--g600); cursor: not-allowed; border-color: #e5e7eb; }
    .row-locked .qinput { pointer-events: none; }

    /* Ø³ÙŠÙ„ÙŠÙƒØª Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…Ù„ÙˆÙ‘Ù† (components, machines...) */
    select.csel          { border: none; font-family: inherit; font-size: 11px; font-weight: 700; padding: 3px 9px; border-radius: 18px; cursor: pointer; outline: none; appearance: none; -webkit-appearance: none; }
    select.csel:disabled { background: #f3f4f6; color: var(--g600); cursor: not-allowed; }

    /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù€ categories */
    .cc  { background: #EFF6FF; color: #2563EB; }  /* Components - Ø£Ø²Ø±Ù‚ */
    .cm  { background: #F0FDF4; color: #16A34A; }  /* Machines - Ø£Ø®Ø¶Ø± */
    .ck  { background: #FFF7ED; color: #EA580C; }  /* Kits - Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
    .cmt { background: #FAF5FF; color: #9333EA; }  /* Materials - Ø¨Ù†ÙØ³Ø¬ÙŠ */

    /* Ø³ÙŠÙ„ÙŠÙƒØª Ø§Ù„Ø£ØµÙ†Ø§Ù (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯) */
    select.isel          { width: 100%; padding: 9px 13px; border: none; background: transparent; font-family: inherit; font-size: 12.5px; color: var(--g800); outline: none; cursor: pointer; appearance: none; -webkit-appearance: none; }
    select.isel:focus    { background: rgba(249,115,22,.04); }
    select.isel:disabled { background: transparent; color: var(--g600); cursor: not-allowed; }
    .row-locked select.isel { pointer-events: none; }

    /* Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù Ø§Ù„ØµØºÙŠØ± */
    .bdel       { background: none; border: none; color: var(--g200); cursor: pointer; font-size: 13px; padding: 4px 7px; border-radius: 5px; transition: all .15s; }
    .bdel:hover { background: #fef2f2; color: #ef4444; }

    /* Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙØ© ØµÙ ÙÙŠ Ø£Ø³ÙÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
    .addrow       { width: 100%; padding: 10px; background: none; border: none; border-top: 1px dashed var(--g200); color: var(--g400); font-family: inherit; font-size: 12px; cursor: pointer; transition: all .15s; display: flex; align-items: center; justify-content: center; gap: 5px; }
    .addrow:hover { background: #FFF7ED; color: var(--or); }

    /* ======================================================
       16. BUTTONS â€” Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¹Ø§Ù…Ø©
       ====================================================== */
    .btn                { padding: 10px 20px; background: var(--or); color: #fff; border: none; border-radius: 10px; font-family: inherit; font-size: 13px; font-weight: 700; cursor: pointer; transition: all .15s; }
    .btn:hover          { background: var(--ord); }
    .btn.secondary      { background: var(--g200); color: var(--g800); }
    .btn.secondary:hover { background: var(--g300); } /* âœ… Ø§Ù„Ø¢Ù† g300 Ù…Ø¹Ø±Ù‘Ù ÙÙŠ CSS vars */

    /* ======================================================
       17. MODALS â€” Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
       ====================================================== */
    .modal         { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.4); z-index: 1000; align-items: center; justify-content: center; }
    .modal.on      { display: flex; }
    .modal-content { background: #fff; border-radius: 16px; padding: 32px; max-width: 500px; width: 90%; box-shadow: 0 20px 60px rgba(0,0,0,.2); }
    .modal-title   { font-size: 18px; font-weight: 800; margin-bottom: 16px; color: var(--g900); }
    .modal-input   { width: 100%; padding: 10px 14px; border: 2px solid var(--g200); border-radius: 10px; font-family: inherit; font-size: 13px; margin-bottom: 12px; outline: none; }
    .modal-input:focus { border-color: var(--or); }
    .modal-buttons { display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; }
    .modal-buttons button { padding: 8px 16px; border: none; border-radius: 8px; font-family: inherit; font-size: 12px; font-weight: 700; cursor: pointer; transition: all .15s; }
    .modal-buttons .btn-cancel      { background: var(--g200); color: var(--g800); }
    .modal-buttons .btn-cancel:hover { background: var(--g300); }
    .modal-buttons .btn-confirm       { background: var(--or); color: #fff; }
    .modal-buttons .btn-confirm:hover { background: var(--ord); }

    /* ======================================================
       18. CHIPS â€” ØªØ´ÙŠØ¨Ø³ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯Ø§Ø±Ø³/Ø§Ù„ÙØ¦Ø§Øª
       ====================================================== */
    .chip-grid { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
    .chip             { padding: 8px 16px; background: var(--g200); color: var(--g800); border: none; border-radius: 20px; font-family: inherit; font-size: 12px; font-weight: 600; cursor: pointer; transition: all .15s; }
    .chip.active      { background: var(--or); color: #fff; }
    .chip:hover       { background: var(--g300); }
    .chip.active:hover { background: var(--ord); }

    /* ======================================================
       19. AUDIT FILTERS â€” ÙÙ„Ø§ØªØ± ØµÙØ­Ø© Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ
       ====================================================== */
    .audit-filters { background: #fff; border-radius: 14px; padding: 20px; border: 1px solid var(--g200); margin-bottom: 24px; display: flex; flex-direction: column; gap: 16px; }
    .filter-row    { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
    .filter-label  { font-size: 12px; font-weight: 700; color: var(--g600); min-width: 60px; }
    .filter-input  { padding: 8px 12px; border: 2px solid var(--g200); border-radius: 8px; font-family: inherit; font-size: 13px; outline: none; }
    .filter-input:focus { border-color: var(--or); }

    /* ======================================================
       20. THEME DATE BAR â€” Ø´Ø±ÙŠØ· Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± ÙÙˆÙ‚ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø«ÙŠÙ…
       ====================================================== */
    .theme-datebar {
      display: flex;
      align-items: center;
      gap: 12px;
      background: #fff;
      border: 1px solid var(--g200);
      border-radius: 12px;
      padding: 12px 18px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .theme-datebar label { font-size: 12px; font-weight: 700; color: var(--g600); white-space: nowrap; }
    .theme-datebar select {
      padding: 7px 12px;
      border: 2px solid var(--g200);
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      font-weight: 600;
      color: var(--g800);
      outline: none;
      background: var(--g50);
      cursor: pointer;
      transition: border .15s;
    }
    .theme-datebar select:focus { border-color: var(--or); }
    .theme-datebar .tdb-sep { width: 1px; height: 22px; background: var(--g200); margin: 0 4px; }
    .theme-datebar .save-tag { font-size: 11px; color: #10b981; font-weight: 700; display: none; }
    .theme-datebar .save-tag.show { display: inline; }

    /* ======================================================
       21. SAVE ROW BUTTON â€” Ø²Ø±Ø§Ø± Ø­ÙØ¸ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯
       ====================================================== */
    .save-row-btn {
      display: none;   /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ â€” ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
      align-items: center;
      gap: 4px;
      padding: 5px 10px;
      background: #10b981;
      color: #fff;
      border: none;
      border-radius: 7px;
      font-family: inherit;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      transition: background .15s;
      white-space: nowrap;
    }
    .save-row-btn:hover { background: #059669; }

  </style>
</head>
<body>

<!-- ============================================================
     LOGIN SCREEN â€” Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
     ============================================================ -->
<div id="login-screen">
  <div class="lcard">
    <!-- Ù„ÙˆØ¬Ùˆ SVG Ù†ØµÙŠ -->
    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 60'%3E%3Ctext x='50%25' y='50%25' font-size='32' font-weight='800' fill='%23F97316' text-anchor='middle' dominant-baseline='middle'%3EPyramakerz%3C/text%3E%3C/svg%3E" class="llogo">
    <div class="ldiv"></div>
    <div class="ltitle">Operation System</div>
    <input type="password" id="pw-input" class="linput" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
           onkeypress="if(event.key==='Enter') tryLogin()">
    <button class="lbtn" onclick="tryLogin()">Ø¯Ø®ÙˆÙ„</button>
    <div class="lerr" id="lerr">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©</div>
  </div>
</div>


<!-- ============================================================
     APP â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„)
     ============================================================ -->
<div id="app">

  <!-- â”€â”€ TOPBAR â”€â”€ -->
  <div class="topbar">
    <div class="tb-logo" onclick="goTo('home')">
      <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='18' fill='%23F97316' opacity='0.1'/%3E%3Ctext x='20' y='24' font-size='20' text-anchor='middle'%3E%F0%9F%8F%A0%3C/text%3E%3C/svg%3E">
      <div class="tb-sep"></div>
      <div class="tb-title">Pyramakerz</div>
    </div>
    <div class="tb-right">
      <div class="sdot"></div>
      <span class="slbl">Ù…ØªØµÙ„</span>
      <button class="tb-back" id="back-btn" onclick="goBack()">â† Ø±Ø¬ÙˆØ¹</button>
    </div>
  </div>

  <!-- â”€â”€ LOADER â€” Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ â”€â”€ -->
  <div class="loader" id="loader">
    <div class="spin"></div>
    <div class="spin-lbl">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>

  <!-- ============================================================
       PAGE: HOME â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
       ============================================================ -->
  <div id="page-home" class="page active">
    <div class="hero">
      <div class="hero-in">
        <div class="htag">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ</div>
        <div class="htitle">Pyramakerz Operation System</div>
        <div class="hsub">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø¯Ø§Ø±Ø³ ÙˆØ§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª</div>
      </div>
    </div>
    <div class="cgrid">
      <div class="mcard" onclick="goTo('schools')">
        <div class="cicon io">ğŸ«</div>
        <div class="cname">Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
        <div class="cdesc">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ ÙˆØ§Ù„Ø«ÙŠÙ…Ø§Øª ÙˆØ§Ù„Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</div>
        <div class="carrow">â†’</div>
      </div>
      <div class="mcard" onclick="goTo('inventory')">
        <div class="cicon ib">ğŸ“¦</div>
        <div class="cname">Ø§Ù„Ø¥Ù†ÙÙ†ØªÙˆØ±ÙŠ</div>
        <div class="cdesc">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ø£ØµÙ†Ø§Ù ÙˆØ§Ù„Ø£Ø¶Ø±Ø§Ø±</div>
        <div class="carrow">â†’</div>
      </div>
      <div class="mcard" onclick="goTo('techday-home')">
        <div class="cicon ig">ğŸ”§</div>
        <div class="cname">Tech Day</div>
        <div class="cdesc">Ø®Ø·Ø· Ø§Ù„ØªØ­Ø¶ÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª ÙˆØ§Ù„ÙØ­ÙˆØµØ§Øª</div>
        <div class="carrow">â†’</div>
      </div>
      <div class="mcard" onclick="goTo('audit')">
        <div class="cicon ip">ğŸ“Š</div>
        <div class="cname">Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ</div>
        <div class="cdesc">Ø¹Ø±Ø¶ Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
        <div class="carrow">â†’</div>
      </div>
    </div>
  </div>

  <!-- ============================================================
       PAGE: SCHOOLS â€” Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³
       ============================================================ -->
  <div id="page-schools" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ« Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
      <button class="btn" onclick="openModal('modal-school')">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø³Ø©</button>
    </div>
    <!-- Ø§Ù„ÙƒØ±ÙˆØª ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† JS -->
    <div class="sgrid" id="schools-grid"></div>
  </div>

  <!-- ============================================================
       PAGE: SCHOOL DETAIL â€” ØªÙØ§ØµÙŠÙ„ Ù…Ø¯Ø±Ø³Ø© (Ø§Ù„Ø«ÙŠÙ…Ø§Øª)
       ============================================================ -->
  <div id="page-school-detail" class="page">
    <div class="ph">
      <div class="ptitle" id="sd-title"></div>
      <button class="btn" onclick="addThemeRow()">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button>
    </div>
    <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Theme One / Theme Two / Theme Three / Ø§Ù„Ø³Ù†Ø© / Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª -->
    <div class="ttabs" id="sd-tabs"></div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± â€” Ø¨ÙŠØªØ­ÙØ¸ Ù…Ø¹ ÙƒÙ„ Ø«ÙŠÙ… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <div class="theme-datebar">
      <label>ğŸ“… Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:</label>
      <select id="theme-year" onchange="saveThemeDate()">
        <option value="">-- Ø§Ø®ØªØ± --</option>
        <option>2024/2025</option>
        <option>2025/2026</option>
        <option>2026/2027</option>
        <option>2027/2028</option>
        <option>2028/2029</option>
        <option>2029/2030</option>
      </select>
      <div class="tdb-sep"></div>
      <label>ğŸ—“ï¸ Ø´Ù‡Ø± Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</label>
      <select id="theme-month" onchange="saveThemeDate()">
        <option value="">-- Ø§Ø®ØªØ± --</option>
        <option value="1">ÙŠÙ†Ø§ÙŠØ±</option>
        <option value="2">ÙØ¨Ø±Ø§ÙŠØ±</option>
        <option value="3">Ù…Ø§Ø±Ø³</option>
        <option value="4">Ø£Ø¨Ø±ÙŠÙ„</option>
        <option value="5">Ù…Ø§ÙŠÙˆ</option>
        <option value="6">ÙŠÙˆÙ†ÙŠÙˆ</option>
        <option value="7">ÙŠÙˆÙ„ÙŠÙˆ</option>
        <option value="8">Ø£ØºØ³Ø·Ø³</option>
        <option value="9">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
        <option value="10">Ø£ÙƒØªÙˆØ¨Ø±</option>
        <option value="11">Ù†ÙˆÙÙ…Ø¨Ø±</option>
        <option value="12">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
      </select>
      <span class="save-tag" id="date-saved-tag">âœ“ ØªÙ… Ø§Ù„Ø­ÙØ¸</span>
    </div>

    <div class="tcard">
      <table>
        <thead><tr>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
          <th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="theme-body"></tbody>
      </table>
      <button class="addrow" onclick="addThemeRow()">+ Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: ANNUAL â€” Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
       ============================================================ -->
  <div id="page-annual" class="page">
    <div class="ph">
      <div class="ptitle" id="an-title"></div>
      <button class="btn" onclick="openModal('modal-year')">+ Ø¥Ø¶Ø§ÙØ© Ø³Ù†Ø©</button>
    </div>
    <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø³Ù†ÙˆØ§Øª ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    <div id="yr-tabs" style="display:flex;gap:6px;margin-bottom:20px;border-bottom:2px solid var(--g200);flex-wrap:wrap;"></div>
    <div id="annual-tables"></div>
  </div>

  <!-- ============================================================
       PAGE: RETURNS â€” Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
       ============================================================ -->
  <div id="page-returns" class="page">
    <div class="ph">
      <div class="ptitle" id="ret-title"></div>
      <button class="btn" onclick="addReturnRow()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø±ØªØ¬Ø¹</button>
    </div>
    <div class="tcard">
      <table>
        <thead><tr>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
          <th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="returns-body"></tbody>
      </table>
      <button class="addrow" onclick="addReturnRow()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø±ØªØ¬Ø¹ Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: INVENTORY â€” Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
       ============================================================ -->
  <div id="page-inventory" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ“¦ Ø§Ù„Ø¥Ù†ÙÙ†ØªÙˆØ±ÙŠ</div>
      <button class="btn" onclick="addInvRow()">+ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
    </div>
    <div class="tcard">
      <table>
        <thead><tr>
          <th style="width:80px">ÙƒÙˆØ¯</th>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="inv-body"></tbody>
      </table>
      <button class="addrow" onclick="addInvRow()">+ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: TECHDAY HOME â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù€ Tech Day
       ============================================================ -->
  <div id="page-techday-home" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ”§ Tech Day</div>
    </div>
    <div class="cgrid">
      <div class="mcard" onclick="goTo('techday-prep')">
        <div class="cicon io">ğŸ“‹</div>
        <div class="cname">Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±</div>
        <div class="cdesc">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ù„Ø®Ø·ÙˆØ§Øª</div>
        <div class="carrow">â†’</div>
      </div>
      <div class="mcard" onclick="goTo('techday-recv')">
        <div class="cicon ib">ğŸ“¦</div>
        <div class="cname">Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª</div>
        <div class="cdesc">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©</div>
        <div class="carrow">â†’</div>
      </div>
      <div class="mcard" onclick="goTo('techday-check')">
        <div class="cicon ig">âœ…</div>
        <div class="cname">Check List</div>
        <div class="cdesc">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…</div>
        <div class="carrow">â†’</div>
      </div>
    </div>
  </div>

  <!-- ============================================================
       PAGE: TECHDAY PREP â€” Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±
       ============================================================ -->
  <div id="page-techday-prep" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ“‹ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±</div>
      <button class="btn" onclick="addTDRow('prep')">+ Ø¥Ø¶Ø§ÙØ© Ø®Ø·ÙˆØ©</button>
    </div>
    <div class="tcard">
      <table>
        <thead><tr>
          <th style="width:50px;text-align:center;">#</th>
          <th>Ø§Ù„Ù…Ù‡Ù…Ø©</th>
          <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="tdprep-body"></tbody>
      </table>
      <button class="addrow" onclick="addTDRow('prep')">+ Ø¥Ø¶Ø§ÙØ© Ø®Ø·ÙˆØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: TECHDAY RECV â€” Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª
       ============================================================ -->
  <div id="page-techday-recv" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ“¦ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª</div>
      <button class="btn" onclick="addTDRow('recv')">+ Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ„Ø§Ù…</button>
    </div>
    <div class="tcard">
      <table>
        <thead><tr>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
          <th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th>
          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="tdrecv-body"></tbody>
      </table>
      <button class="addrow" onclick="addTDRow('recv')">+ Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ„Ø§Ù… Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: TECHDAY CHECK â€” Check List
       ============================================================ -->
  <div id="page-techday-check" class="page">
    <div class="ph">
      <div class="ptitle">âœ… Check List</div>
      <button class="btn" onclick="addTDRow('check')">+ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±</button>
    </div>
    <div class="tcard">
      <table>
        <thead><tr>
          <th style="width:50px;text-align:center;">âœ“</th>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="tdcheck-body"></tbody>
      </table>
      <button class="addrow" onclick="addTDRow('check')">+ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <!-- ============================================================
       PAGE: AUDIT â€” Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ
       ============================================================ -->
  <div id="page-audit" class="page">
    <div class="ph">
      <div class="ptitle">ğŸ“Š Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ</div>
      <button class="btn" onclick="addAuditRow()">+ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±</button>
    </div>

    <!-- ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø« -->
    <div class="audit-filters">
      <!-- ØµÙ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± -->
      <div class="filter-row">
        <div class="filter-label">ğŸ“… Ø§Ù„Ø³Ù†Ø©:</div>
        <select id="audit-year" class="filter-input" onchange="renderAudit()" style="min-width:140px">
          <option value="">ÙƒÙ„ Ø§Ù„Ø³Ù†ÙˆØ§Øª</option>
          <option>2024/2025</option>
          <option>2025/2026</option>
          <option>2026/2027</option>
          <option>2027/2028</option>
          <option>2028/2029</option>
          <option>2029/2030</option>
        </select>
        <div class="filter-label" style="margin-right:16px">ğŸ—“ï¸ Ø§Ù„Ø´Ù‡Ø±:</div>
        <select id="audit-month" class="filter-input" onchange="renderAudit()" style="min-width:130px">
          <option value="">ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±</option>
          <option value="1">ÙŠÙ†Ø§ÙŠØ±</option>
          <option value="2">ÙØ¨Ø±Ø§ÙŠØ±</option>
          <option value="3">Ù…Ø§Ø±Ø³</option>
          <option value="4">Ø£Ø¨Ø±ÙŠÙ„</option>
          <option value="5">Ù…Ø§ÙŠÙˆ</option>
          <option value="6">ÙŠÙˆÙ†ÙŠÙˆ</option>
          <option value="7">ÙŠÙˆÙ„ÙŠÙˆ</option>
          <option value="8">Ø£ØºØ³Ø·Ø³</option>
          <option value="9">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
          <option value="10">Ø£ÙƒØªÙˆØ¨Ø±</option>
          <option value="11">Ù†ÙˆÙÙ…Ø¨Ø±</option>
          <option value="12">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
        </select>
      </div>
      <!-- ØµÙ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ -->
      <div class="filter-row">
        <div class="filter-label">ğŸ« Ø§Ù„Ù…Ø¯Ø§Ø±Ø³:</div>
        <div id="audit-school-chips" class="chip-grid" style="flex:1"></div>
      </div>
    </div>

    <div class="tcard">
      <table>
        <thead><tr>
          <th class="tc">Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th class="tq">Ø§Ù„Ù…Ø±Ø³Ù„Ø©</th>
          <th class="tq">Ø§Ù„ÙØ¹Ù„ÙŠØ©</th>
          <th class="tq">Ø§Ù„ØªØ§Ù„ÙÙŠØ§Øª</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th class="ta">Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr></thead>
        <tbody id="audit-body"></tbody>
      </table>
      <button class="addrow" onclick="addAuditRow()">+ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

</div><!-- /app -->


<!-- ============================================================
     MODALS â€” Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
     ============================================================ -->

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø³Ø© -->
<div id="modal-school" class="modal">
  <div class="modal-content">
    <div class="modal-title">Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>
    <input type="text" id="ms-name" class="modal-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
    <input type="text" id="ms-icon" class="modal-input" placeholder="Ø£ÙŠÙ‚ÙˆÙ†Ø© (emoji)">
    <div class="modal-buttons">
      <button class="btn-cancel" onclick="closeModal('modal-school')">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn-confirm" onclick="confirmAddSchool()">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¶Ø§ÙØ© Ø³Ù†Ø© Ø¯Ø±Ø§Ø³ÙŠØ© -->
<div id="modal-year" class="modal">
  <div class="modal-content">
    <div class="modal-title">Ø¥Ø¶Ø§ÙØ© Ø³Ù†Ø© Ø¯Ø±Ø§Ø³ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</div>
    <input type="text" id="my-name" class="modal-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©">
    <div class="modal-buttons">
      <button class="btn-cancel" onclick="closeModal('modal-year')">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn-confirm" onclick="confirmAddYear()">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
  </div>
</div>


<!-- ============================================================
     JAVASCRIPT
     ============================================================ -->
<script>

  /* ==============================================================
     1. SUPABASE CONFIG â€” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
     ================================================================
     âš ï¸  Ù…Ù‡Ù…: ØºÙŠÙ‘Ø± SURL Ùˆ SKEY Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Supabase
     ==============================================================*/
  const SURL = 'https://xyzabc.supabase.co';   // Ø±Ø§Ø¨Ø· Ù…Ø´Ø±ÙˆØ¹Ùƒ
  const SKEY = 'eyJhbGc...';                    // Ù…ÙØªØ§Ø­ anon Ø§Ù„Ø®Ø§Øµ Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ

  const { createClient } = supabase;
  const db = createClient(SURL, SKEY);


  /* ==============================================================
     2. AUTH â€” Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
     ================================================================
     âš ï¸  Ø£Ù…Ø§Ù†: ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‡Ù†Ø§ Ù…Ø®ÙÙŠØ© Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ù„ÙƒÙ†
     Ø£ÙŠ Ù…Ø·ÙˆÙ‘Ø± ÙŠÙØªØ­ Ø§Ù„Ù€ DevTools ÙŠÙ‚Ø¯Ø± ÙŠØ´ÙˆÙÙ‡Ø§.
     Ø§Ù„Ø­Ù„ Ø§Ù„Ø£ÙØ¶Ù„ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹: Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase Auth.
     ==============================================================*/
  const PASS = 'pyramakerz';  // â† ØºÙŠÙ‘Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‡Ù†Ø§

  /* Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±Ø§Ø± */
  function tryLogin() {
    const input = document.getElementById('pw-input');
    if (input.value === PASS) {
      // ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØµØ­ â†’ Ø£Ø®ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ£Ø¸Ù‡Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('app').style.display = 'block';
      sessionStorage.setItem('pa', '1');  // Ø§Ø­ÙØ¸ Ø§Ù„Ø¬Ù„Ø³Ø©
      init();
    } else {
      // ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙ„Ø· â†’ Ø£Ø¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
      document.getElementById('lerr').style.display = 'block';
      input.value = '';
    }
  }

  /* Ù„Ùˆ Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ø­ÙÙˆØ¸Ø© â†’ ØªØ¬Ø§ÙˆØ² Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© */
  if (sessionStorage.getItem('pa') === '1') {
    document.getElementById('login-screen').style.display = 'none';
    document.getElementById('app').style.display = 'block';
    document.addEventListener('DOMContentLoaded', init);
  }


  /* ==============================================================
     3. LOADER HELPERS â€” ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„
     ==============================================================*/
  const ld = () => document.getElementById('loader').classList.add('on');    // show loader
  const uh = () => document.getElementById('loader').classList.remove('on'); // hide loader


  /* ==============================================================
     4. STATE â€” Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
     ================================================================
     Ø¨ØªØ®Ø²Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„ÙŠ Ø§ØªØ­Ù…Ù„Øª Ù…Ù† Supabase Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ø¶Ù‡Ø§
     ==============================================================*/
  let schools       = [];   // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³
  let inventory     = [];   // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
  let themeRows     = [];   // ØµÙÙˆÙ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
  let returnRows    = [];   // ØµÙÙˆÙ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
  let annualRows    = [];   // ØµÙÙˆÙ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
  let tdPrep        = [];   // ØµÙÙˆÙ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±
  let tdRecv        = [];   // ØµÙÙˆÙ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª
  let tdCheck       = [];   // ØµÙÙˆÙ Ø§Ù„Ù€ Check List

  /* Ø§Ù„Ù€ state Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„ØªÙ†Ù‚Ù„ */
  let curPage             = 'home';
  let curSchoolId         = null;
  let curTheme            = 0;      // 0=Theme One, 1=Theme Two, 2=Theme Three
  let curYear             = null;
  let curAnnualSchoolId   = null;
  let curReturnSchoolId   = null;

  /* Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±ÙŠÙ† Ù„ÙƒÙ„ Ø«ÙŠÙ… ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø«ÙŠÙ… */
  let curThemeYear  = '';   // Ù…Ø«Ø§Ù„: "2025/2026"
  let curThemeMonth = '';   // Ù…Ø«Ø§Ù„: "9" (Ø³Ø¨ØªÙ…Ø¨Ø±)

  /* Ø­Ø§Ù„Ø© Ø§Ù„Ù€ lock Ù„ÙƒÙ„ ØµÙ (Ù…Ù‚ÙÙ„ = Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„) */
  let rowEditStates = {};

  /* Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙÙŠ ÙÙ„ØªØ± Ø§Ù„Ø¬Ø±Ø¯ */
  let auditSelectedSchools = new Set();


  /* ==============================================================
     5. MODAL HELPERS â€” ÙØªØ­ ÙˆØºÙ„Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
     ==============================================================*/
  function openModal(id)  { document.getElementById(id).classList.add('on'); }
  function closeModal(id) { document.getElementById(id).classList.remove('on'); }


  /* ==============================================================
     6. NAVIGATION HISTORY â€” Ø³Ø¬Ù„ Ø§Ù„ØªÙ†Ù‚Ù„ (Ø¨Ø¯ÙˆÙ† URL)
     ================================================================
     Ø¨Ù†Ø³ØªØ®Ø¯Ù… array ÙÙŠ Ø§Ù„Ù€ memory Ø¨Ø¯Ù„ history.pushState
     Ù„Ø£Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø´ØºØ§Ù„ Ø¯Ø§Ø®Ù„ iframe ÙˆÙ…Ø´ Ù…Ø³Ù…ÙˆØ­ Ø¨ØªØºÙŠÙŠØ± Ø§Ù„Ù€ URL
     ==============================================================*/

  /* Ø³Ø¬Ù„ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù„ÙŠ Ø²ÙˆØ±Ù†Ø§Ù‡Ø§ (Ù„Ù„Ù€ Back button) */
  let navHistory = [];

  /* Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ */
  function pushHistory() {
    navHistory.push({
      page:           curPage,
      schoolId:       curSchoolId,
      theme:          curTheme,
      year:           curYear,
      annualSchoolId: curAnnualSchoolId,
      returnSchoolId: curReturnSchoolId,
    });
  }

  /* Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø®Ø·ÙˆØ© Ù„Ù„ÙˆØ±Ø§Ø¡ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„ */
  function popHistory() {
    if (navHistory.length === 0) return null;
    return navHistory.pop();
  }


  /* ==============================================================
     7. NAVIGATION â€” Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
     ==============================================================*/

  /* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ù…Ø¹ÙŠÙ†Ø© */
  function goTo(page, extra) {
    // Ø§Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ (Ø¥Ù„Ø§ Ù„Ùˆ Ø¨Ù†Ø±Ø¬Ø¹ Ù„Ù„Ù€ home Ù…Ù† Ø£ÙˆÙ„)
    if (curPage !== page) pushHistory();

    // Ø£Ø®ÙÙŠ ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    // Ø£Ø¸Ù‡Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
    const el = document.getElementById('page-' + page);
    if (el) el.classList.add('active');

    curPage = page;

    // Ø£Ø¸Ù‡Ø±/Ø£Ø®ÙÙŠ Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø©
    document.getElementById('back-btn').classList.toggle('show', page !== 'home');

    // Ø­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
    if      (page === 'schools')        loadSchools();
    else if (page === 'school-detail')  { curSchoolId = extra; loadSchoolDetail(); }
    else if (page === 'annual')         { curAnnualSchoolId = extra; loadAnnual(); }
    else if (page === 'returns')        { curReturnSchoolId = extra; loadReturns(); }
    else if (page === 'inventory')      loadInventory();
    else if (page === 'techday-prep')   loadTD('prep');
    else if (page === 'techday-recv')   loadTD('recv');
    else if (page === 'techday-check')  loadTD('check');
    else if (page === 'audit')          loadAudit();
  }

  /* Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ù€ Topbar â€” ÙŠØ±Ø¬Ø¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ù€ memory */
  function goBack() {
    const prev = popHistory();
    if (!prev) { goTo('home'); return; }

    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù€ state Ø§Ù„Ù‚Ø¯ÙŠÙ…
    curSchoolId       = prev.schoolId;
    curTheme          = prev.theme;
    curYear           = prev.year;
    curAnnualSchoolId = prev.annualSchoolId;
    curReturnSchoolId = prev.returnSchoolId;

    // Ø§Ù†ØªÙ‚Ù„ Ø¨Ø¯ÙˆÙ† Ù…Ø§ Ù†Ø¶ÙŠÙ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ ØªØ§Ù†ÙŠ
    navHistory.pop(); // Ù†Ø´ÙŠÙ„ Ø§Ù„Ù€ push Ø§Ù„Ù„ÙŠ Ø¹Ù…Ù„Ø§Ù‡ goTo Ù„Ù„ØªÙˆ
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    const el = document.getElementById('page-' + prev.page);
    if (el) el.classList.add('active');
    curPage = prev.page;
    document.getElementById('back-btn').classList.toggle('show', prev.page !== 'home');

    if      (prev.page === 'schools')        loadSchools();
    else if (prev.page === 'school-detail')  loadSchoolDetail();
    else if (prev.page === 'annual')         loadAnnual();
    else if (prev.page === 'returns')        loadReturns();
    else if (prev.page === 'inventory')      loadInventory();
    else if (prev.page === 'techday-prep')   loadTD('prep');
    else if (prev.page === 'techday-recv')   loadTD('recv');
    else if (prev.page === 'techday-check')  loadTD('check');
    else if (prev.page === 'audit')          loadAudit();
  }


  /* ==============================================================
     8. SCHOOLS â€” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³
     ==============================================================*/

  /* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ù…Ù† Supabase */
  async function loadSchools() {
    ld();
    const { data } = await db.from('schools').select('*').order('created_at');
    schools = data || [];
    renderSchools();
    uh();
  }

  /* Ø±Ø³Ù… ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ */
  function renderSchools() {
    const grid = document.getElementById('schools-grid');
    grid.innerHTML = '';
    schools.forEach(s => {
      const div = document.createElement('div');
      div.className = 'scard';
      // âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­: Ø¨Ù†Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø«ÙŠÙ…Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´ hardcoded
      const themeCount = 3; // Ø«Ø§Ø¨Øª Ù„Ø£Ù† ÙƒÙ„ Ù…Ø¯Ø±Ø³Ø© Ø¯Ø§ÙŠÙ…Ø§Ù‹ Ø¹Ù†Ø¯Ù‡Ø§ 3 themes
      div.innerHTML = `
        <button class="sdel" onclick="event.stopPropagation(); delSchool('${s.id}')">âœ•</button>
        <div class="sicon">${s.icon || 'ğŸ«'}</div>
        <div class="sname">${s.name}</div>
        <div class="smeta">${themeCount} Ø«ÙŠÙ…Ø§Øª â€¢ Ø§Ø¶ØºØ· Ù„Ù„Ø¯Ø®ÙˆÙ„</div>`;
      div.onclick = () => goTo('school-detail', s.id);
      grid.appendChild(div);
    });
  }

  /* ØªØ£ÙƒÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø© */
  async function confirmAddSchool() {
    const name = document.getElementById('ms-name').value.trim();
    const icon = document.getElementById('ms-icon').value.trim() || 'ğŸ«';
    if (!name) return;
    ld();
    closeModal('modal-school');
    document.getElementById('ms-name').value = '';
    document.getElementById('ms-icon').value = '';
    const id = 's' + Date.now();
    await db.from('schools').insert({ id, name, icon });
    await loadSchools();
    uh();
  }

  /* Ø­Ø°Ù Ù…Ø¯Ø±Ø³Ø© ÙˆÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ */
  async function delSchool(id) {
    if (!confirm('ØªØ­Ø°Ù Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø¯ÙŠ ÙˆÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ØŸ')) return;
    ld();
    // âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­: Ø¨Ù†Ø­Ø°Ù school_years ÙƒÙ…Ø§Ù† Ù…Ø´ Ø¨Ø³ themes Ùˆreturns
    await db.from('school_themes').delete().eq('school_id', id);
    await db.from('school_returns').delete().eq('school_id', id);
    await db.from('school_years').delete().eq('school_id', id);   // â† Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
    await db.from('schools').delete().eq('id', id);
    await loadSchools();
    uh();
  }


  /* ==============================================================
     9. SCHOOL DETAIL â€” ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ø§Ù„Ø«ÙŠÙ…Ø§Øª)
     ==============================================================*/

  /* ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ù…Ø¯Ø±Ø³Ø© */
  async function loadSchoolDetail() {
    ld();
    const s = schools.find(x => x.id === curSchoolId);
    if (!s) { uh(); return; }
    document.getElementById('sd-title').textContent = (s.icon || 'ğŸ«') + ' ' + s.name;
    buildSchoolTabs(curSchoolId);
    await loadTheme();
    uh();
  }

  /* Ø¨Ù†Ø§Ø¡ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª (Theme One/Two/Three + Ø§Ù„Ø³Ù†Ø© + Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª) */
  function buildSchoolTabs(schoolId) {
    const tabs = document.getElementById('sd-tabs');
    tabs.innerHTML = '';

    // Ø«ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø«Ù„Ø§Ø«Ø©
    ['Theme One', 'Theme Two', 'Theme Three'].forEach((name, i) => {
      const btn = document.createElement('button');
      btn.className = 'ttab' + (i === curTheme ? ' active' : '');
      btn.textContent = name;
      btn.onclick = () => {
        curTheme = i;
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ active class
        tabs.querySelectorAll('.ttab').forEach((b, bi) => b.classList.toggle('active', bi === i));
        loadTheme();
      };
      tabs.appendChild(btn);
    });

    // Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
    const btnAnnual = document.createElement('button');
    btnAnnual.className = 'ttab';
    btnAnnual.textContent = 'ğŸ“… Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©';
    btnAnnual.style.cssText = 'background:#EFF6FF;color:#2563EB;border-color:#BFDBFE;';
    btnAnnual.onclick = () => goTo('annual', schoolId);
    tabs.appendChild(btnAnnual);

    // Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
    const btnReturn = document.createElement('button');
    btnReturn.className = 'ttab';
    btnReturn.textContent = 'â†©ï¸ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª';
    btnReturn.style.cssText = 'background:#FDF2F8;color:#9333EA;border-color:#E9D5FF;';
    btnReturn.onclick = () => goTo('returns', schoolId);
    tabs.appendChild(btnReturn);
  }

  /* ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ */
  async function loadTheme() {
    ld();
    const { data } = await db.from('school_themes')
      .select('*')
      .eq('school_id', curSchoolId)
      .eq('theme_index', curTheme)
      .order('sort_order');
    themeRows     = data || [];
    rowEditStates = {};
    await loadThemeDate();   // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†
    renderThemeTable();
    uh();
  }

  /* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ† Ù„Ù‡Ø°Ø§ Ø§Ù„Ø«ÙŠÙ… Ù…Ù† Ø¬Ø¯ÙˆÙ„ theme_dates */
  async function loadThemeDate() {
    const { data } = await db.from('theme_dates')
      .select('*')
      .eq('school_id', curSchoolId)
      .eq('theme_index', curTheme)
      .maybeSingle();
    curThemeYear  = data?.year  || '';
    curThemeMonth = data?.month || '';
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ UI
    const selYear  = document.getElementById('theme-year');
    const selMonth = document.getElementById('theme-month');
    if (selYear)  selYear.value  = curThemeYear;
    if (selMonth) selMonth.value = curThemeMonth;
    // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    const tag = document.getElementById('date-saved-tag');
    if (tag) tag.classList.remove('show');
  }

  /* Ø­ÙØ¸ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ±Ù‡Ù… â€” upsert ÙÙŠ Ø¬Ø¯ÙˆÙ„ theme_dates */
  async function saveThemeDate() {
    const year  = document.getElementById('theme-year').value;
    const month = document.getElementById('theme-month').value;
    curThemeYear  = year;
    curThemeMonth = month;
    // upsert: Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯ â†’ updateØŒ Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ â†’ insert
    await db.from('theme_dates').upsert({
      school_id:   curSchoolId,
      theme_index: curTheme,
      year,
      month,
    }, { onConflict: 'school_id,theme_index' });
    // Ø£Ø¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø«Ù… Ø£Ø®ÙÙŠÙ‡Ø§
    const tag = document.getElementById('date-saved-tag');
    if (tag) {
      tag.classList.add('show');
      setTimeout(() => tag.classList.remove('show'), 2000);
    }
  }

  /* Ø±Ø³Ù… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø«ÙŠÙ… â€” ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ ØªØ¨Ø¯Ø£ locked Ø¥Ù„Ø§ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
  function renderThemeTable() {
    const tbody = document.getElementById('theme-body');
    tbody.innerHTML = '';

    themeRows.forEach((row, i) => {
      const invItems = inventory.filter(x => x.cat === row.cat);
      const isCustom = row.item && !invItems.find(x => x.name === row.item);
      /* Ø§Ù„ØµÙ ÙŠÙƒÙˆÙ† Ù…ÙØªÙˆØ­ Ù„Ùˆ Ù‡Ùˆ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙŠ Ù„Ø³Ù‡ Ø§ØªÙØªØ­ */
      const isLocked = row.id !== newRowId;

      const catOpts = ['components','machines','kits','materials']
        .map(c => `<option value="${c}" ${c === row.cat ? 'selected' : ''}>${catLabel(c)}</option>`)
        .join('');

      const itemOpts = `<option value="">-- Ø§Ø®ØªØ± --</option>` +
        invItems.map(x => `<option value="${x.name}" ${x.name === row.item ? 'selected' : ''}>${x.name}</option>`).join('') +
        `<option value="__c__" ${isCustom ? 'selected' : ''}>âœï¸ ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠ</option>`;

      const tr = document.createElement('tr');
      tr.id        = 'row-' + row.id;
      tr.className = isLocked ? 'row-locked' : '';
      tr.innerHTML = `
        <td class="tdc">
          <select class="csel c${catAbbr(row.cat)}" onchange="onThemeCat(${i},this)" ${isLocked ? 'disabled' : ''}>${catOpts}</select>
        </td>
        <td>
          <select class="isel" onchange="onThemeItem(${i},this)" ${isLocked ? 'disabled' : ''}>${itemOpts}</select>
          <input type="text" class="cedit" style="display:${isCustom ? 'block' : 'none'};padding-top:0;min-height:28px"
            value="${isCustom ? row.item : ''}" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…..."
            onchange="updateTheme(${i},'item',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${row.id}')">
        </td>
        <td class="tdq">
          <div class="qctr">
            <button onclick="changeQty('theme',${i},-1)" ${isLocked ? 'disabled' : ''}>âˆ’</button>
            <span id="qty-theme-${i}">${row.qty || 0}</span>
            <button onclick="changeQty('theme',${i},1)"  ${isLocked ? 'disabled' : ''}>+</button>
          </div>
        </td>
        <td>
          <textarea class="cedit" rows="1" oninput="ar(this)"
            onchange="updateTheme(${i},'note',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${row.id}')">${row.note || ''}</textarea>
        </td>
        <td class="tda">
          <div class="act-wrap">
            <button class="save-row-btn" style="display:${!isLocked ? 'inline-flex' : 'none'}"
              onclick="lockRow('${row.id}')">âœ“ Ø­ÙØ¸</button>
            <button class="act-btn" onclick="toggleMenu(this)" style="display:${isLocked ? 'inline-block' : 'none'}">â‹®</button>
            <div class="act-menu">
              <button onclick="unlockRow('${row.id}');closeAllMenus()">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="danger" onclick="delThemeRow('${row.id}',${i});closeAllMenus()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </div>
          </div>
        </td>`;
      tbody.appendChild(tr);
    });

    tbody.querySelectorAll('textarea').forEach(ar);
  }

  /* Ù„Ù…Ø§ ÙŠØªØºÙŠØ± Ø§Ù„ØµÙ†Ù â†’ Ù†Ø­Ø¯Ù‘Ø« Ù„ÙˆÙ† Ø§Ù„Ù€ select ÙˆÙ†Ø¹ÙŠØ¯ Ø±Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
  function onThemeCat(i, sel) {
    sel.className = `csel c${catAbbr(sel.value)}`;
    updateTheme(i, 'cat', sel.value);
    setTimeout(() => renderThemeTable(), 50); // ØªØ£Ø®ÙŠØ± ØµØºÙŠØ± Ø¹Ø´Ø§Ù† Ø§Ù„Ù€ update ÙŠØ®Ù„Øµ
  }

  /* Ù„Ù…Ø§ ÙŠØªØºÙŠØ± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø§Ø¯Ø© */
  function onThemeItem(i, sel) {
    const inp = sel.nextElementSibling;
    if (sel.value === '__c__') {
      // ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠ â†’ Ø£Ø¸Ù‡Ø± Ø­Ù‚Ù„ Ø§Ù„Ù†Øµ
      inp.style.display = 'block';
      inp.focus();
    } else {
      inp.style.display = 'none';
      updateTheme(i, 'item', sel.value);
    }
  }

  async function updateTheme(i, field, val) {
    const row = themeRows[i];
    if (!row) return;
    row[field] = val;
    await db.from('school_themes').update({ [field]: val }).eq('id', row.id);
  }

  async function addThemeRow() {
    ld();
    const id = 'st' + Date.now();
    newRowId = id;   // Ù†Ø­Ø¯Ø¯ Ø§Ù„Ù€ id Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø±Ø§Ø¬ Ø¹Ø´Ø§Ù† renderThemeTable ÙŠØ¹Ø±ÙÙ‡
    await db.from('school_themes').insert({
      id, school_id: curSchoolId, theme_index: curTheme,
      cat: 'components', item: '', qty: 0, note: '',
      sort_order: themeRows.length
    });
    await loadTheme();
    uh();
    // Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø³Ù… â€” Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯
    const newRow = document.getElementById('row-' + id);
    if (newRow) {
      newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      const firstInput = newRow.querySelector('select, textarea, input:not([disabled])');
      if (firstInput) firstInput.focus();
    }
  }

  async function delThemeRow(id, i) {
    if (!confirm('ØªØ­Ø°Ù Ø§Ù„ØµÙØŸ')) return;
    ld();
    await db.from('school_themes').delete().eq('id', id);
    themeRows.splice(i, 1);
    delete rowEditStates[id];
    renderThemeTable();
    uh();
  }


  /* ==============================================================
     10. ANNUAL â€” Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
     ==============================================================*/

  async function loadAnnual() {
    ld();
    const s = schools.find(x => x.id === curAnnualSchoolId);
    document.getElementById('an-title').textContent =
      (s?.icon || 'ğŸ«') + ' ' + (s?.name || '') + ' â€” Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©';

    const { data: yrs } = await db.from('school_years')
      .select('*').eq('school_id', curAnnualSchoolId).order('created_at');
    const years = yrs || [];

    renderYearTabs(years);

    if (years.length > 0) {
      if (!curYear) curYear = years[0].id;
      await loadAnnualRows();
    } else {
      curYear = null;
      document.getElementById('annual-tables').innerHTML =
        '<div style="text-align:center;padding:40px;color:var(--g400)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ù†ÙˆØ§Øª Ø¯Ø±Ø§Ø³ÙŠØ© â€” Ø£Ø¶Ù Ø³Ù†Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>';
    }
    uh();
  }

  /* Ø±Ø³Ù… ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø³Ù†ÙˆØ§Øª */
  function renderYearTabs(years) {
    const container = document.getElementById('yr-tabs');
    container.innerHTML = '';
    years.forEach(y => {
      const btn = document.createElement('button');
      btn.className = 'yr-tab' + (y.id === curYear ? ' active' : '');  // âœ… ÙŠØ³ØªØ®Ø¯Ù… .yr-tab
      btn.textContent = y.name;
      btn.onclick = () => {
        curYear = y.id;
        container.querySelectorAll('.yr-tab').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        loadAnnualRows();
      };
      container.appendChild(btn);
    });
  }

  /* ØªØ­Ù…ÙŠÙ„ ØµÙÙˆÙ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© (Ø¨ÙŠØ¹Ø±Ø¶ Ù†ÙØ³ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«ÙŠÙ…Ø§Øª) */
  async function loadAnnualRows() {
    ld();
    const { data: themes } = await db.from('school_themes')
      .select('*')
      .eq('school_id', curAnnualSchoolId)
      .order('theme_index')
      .order('sort_order');
    annualRows = themes || [];
    renderAnnualTable();
    uh();
  }

  /* Ø±Ø³Ù… Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© (Ù…Ø¬Ù…Ù‘Ø¹Ø© Ø¨Ø§Ù„Ø«ÙŠÙ…) */
  function renderAnnualTable() {
    const cont   = document.getElementById('annual-tables');
    cont.innerHTML = '';
    const tnames = ['Theme One', 'Theme Two', 'Theme Three'];

    [0, 1, 2].forEach(t => {
      const rows = annualRows.filter(r => r.theme_index === t);
      if (!rows.length) return;

      const sec = document.createElement('div');
      sec.style.marginBottom = '20px';

      let html = `<div style="font-size:14px;font-weight:800;color:var(--or);margin-bottom:10px;padding:8px 14px;background:var(--orb);border-radius:8px;border-right:4px solid var(--or)">${tnames[t]}</div>`;
      html += `<div class="tcard"><table><thead><tr>
        <th class="tc">Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th class="tq">Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
      </tr></thead><tbody>`;

      rows.forEach((r, i) => {
        html += `<tr style="background:${i % 2 ? '#fafafa' : '#fff'}">
          <td style="padding:9px 13px"><span style="padding:3px 9px;border-radius:14px;font-size:11px;font-weight:700;background:${catBg(r.cat)};color:${catClr(r.cat)}">${catLabel(r.cat)}</span></td>
          <td style="padding:9px 13px">${r.item || '-'}</td>
          <td style="padding:9px 13px;text-align:center;font-weight:700;color:var(--or)">${r.qty || 0}</td>
          <td style="padding:9px 13px;color:var(--g600)">${r.note || '-'}</td>
        </tr>`;
      });

      html += `</tbody></table></div>`;
      sec.innerHTML = html;
      cont.appendChild(sec);
    });
  }

  /* ØªØ£ÙƒÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø³Ù†Ø© Ø¯Ø±Ø§Ø³ÙŠØ© */
  async function confirmAddYear() {
    const name = document.getElementById('my-name').value.trim();
    if (!name) return;
    ld();
    closeModal('modal-year');
    document.getElementById('my-name').value = '';
    const id = 'y' + Date.now();
    await db.from('school_years').insert({ id, school_id: curAnnualSchoolId, name });
    await loadAnnual();
    uh();
  }


  /* ==============================================================
     11. RETURNS â€” Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
     ==============================================================*/

  async function loadReturns() {
    ld();
    const s = schools.find(x => x.id === curReturnSchoolId);
    document.getElementById('ret-title').textContent = 'â†©ï¸ Ù…Ø±ØªØ¬Ø¹Ø§Øª â€” ' + (s?.name || '');

    const { data } = await db.from('school_returns')
      .select('*').eq('school_id', curReturnSchoolId).order('created_at');
    returnRows    = data || [];
    rowEditStates = {};
    renderReturns();
    uh();
  }

  function renderReturns() {
    const tbody = document.getElementById('returns-body');
    tbody.innerHTML = '';

    returnRows.forEach((row, i) => {
      const invItems = inventory.filter(x => x.cat === row.cat);
      const isCustom = row.item && !invItems.find(x => x.name === row.item);
      const isLocked = row.id !== newRowId;

      const catOpts = ['components','machines','kits','materials']
        .map(c => `<option value="${c}" ${c === row.cat ? 'selected' : ''}>${catLabel(c)}</option>`)
        .join('');

      const itemOpts = `<option value="">-- Ø§Ø®ØªØ± --</option>` +
        invItems.map(x => `<option value="${x.name}" ${x.name === row.item ? 'selected' : ''}>${x.name}</option>`).join('') +
        `<option value="__c__" ${isCustom ? 'selected' : ''}>âœï¸ ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠ</option>`;

      const tr = document.createElement('tr');
      tr.id        = 'row-' + row.id;
      tr.className = isLocked ? 'row-locked' : '';
      tr.innerHTML = `
        <td class="tdc">
          <select class="csel c${catAbbr(row.cat)}" onchange="onRetCat(${i},this)" ${isLocked ? 'disabled' : ''}>${catOpts}</select>
        </td>
        <td>
          <select class="isel" onchange="onRetItem(${i},this)" ${isLocked ? 'disabled' : ''}>${itemOpts}</select>
          <input type="text" class="cedit" style="display:${isCustom ? 'block' : 'none'};padding-top:0;min-height:28px"
            value="${isCustom ? row.item : ''}" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…..."
            onchange="updateRet(${i},'item',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${row.id}')">
        </td>
        <td class="tdq">
          <div class="qctr">
            <button onclick="changeQty('ret',${i},-1)" ${isLocked ? 'disabled' : ''}>âˆ’</button>
            <span id="qty-ret-${i}">${row.qty || 0}</span>
            <button onclick="changeQty('ret',${i},1)"  ${isLocked ? 'disabled' : ''}>+</button>
          </div>
        </td>
        <td>
          <textarea class="cedit" rows="1" oninput="ar(this)"
            onchange="updateRet(${i},'note',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${row.id}')">${row.note || ''}</textarea>
        </td>
        <td class="tda">
          <div class="act-wrap">
            <button class="save-row-btn" style="display:${!isLocked ? 'inline-flex' : 'none'}"
              onclick="lockRow('${row.id}')">âœ“ Ø­ÙØ¸</button>
            <button class="act-btn" onclick="toggleMenu(this)" style="display:${isLocked ? 'inline-block' : 'none'}">â‹®</button>
            <div class="act-menu">
              <button onclick="unlockRow('${row.id}');closeAllMenus()">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="danger" onclick="delRetRow('${row.id}',${i});closeAllMenus()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </div>
          </div>
        </td>`;
      tbody.appendChild(tr);
    });

    tbody.querySelectorAll('textarea').forEach(ar);
  }

  function onRetCat(i, sel) {
    sel.className = `csel c${catAbbr(sel.value)}`;
    updateRet(i, 'cat', sel.value);
    setTimeout(() => renderReturns(), 50);
  }

  function onRetItem(i, sel) {
    const inp = sel.nextElementSibling;
    if (sel.value === '__c__') { inp.style.display = 'block'; inp.focus(); }
    else { inp.style.display = 'none'; updateRet(i, 'item', sel.value); }
  }

  async function updateRet(i, field, val) {
    const row = returnRows[i];
    if (!row) return;
    row[field] = val;
    await db.from('school_returns').update({ [field]: val }).eq('id', row.id);
  }

  async function addReturnRow() {
    ld();
    const id = 'sr' + Date.now();
    newRowId = id;
    await db.from('school_returns').insert({
      id, school_id: curReturnSchoolId, cat: 'components', item: '', qty: 0, note: ''
    });
    await loadReturns();
    uh();
    const newRow = document.getElementById('row-' + id);
    if (newRow) {
      newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      const firstInput = newRow.querySelector('select, textarea');
      if (firstInput) firstInput.focus();
    }
  }

  async function delRetRow(id, i) {
    if (!confirm('ØªØ­Ø°Ù Ø§Ù„ØµÙØŸ')) return;
    ld();
    await db.from('school_returns').delete().eq('id', id);
    returnRows.splice(i, 1);
    delete rowEditStates[id];
    renderReturns();
    uh();
  }


  /* ==============================================================
     12. INVENTORY â€” Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
     ==============================================================*/

  async function loadInventory() {
    ld();
    const { data } = await db.from('inventory').select('*').order('cat').order('name');
    inventory     = data || [];
    rowEditStates = {};
    renderInventory();
    uh();
  }

  function renderInventory() {
    const tbody = document.getElementById('inv-body');
    tbody.innerHTML = '';

    inventory.forEach((r, i) => {
      const catOpts = ['components','machines','kits','materials']
        .map(c => `<option value="${c}" ${c === r.cat ? 'selected' : ''}>${catLabel(c)}</option>`)
        .join('');
      const isLocked = r.id !== newRowId;

      const tr = document.createElement('tr');
      tr.id        = 'row-' + r.id;
      tr.className = isLocked ? 'row-locked' : '';
      tr.innerHTML = `
        <td><input type="text" class="cedit" value="${r.id.substring(0, 6)}" disabled></td>
        <td class="tdc">
          <select class="csel c${catAbbr(r.cat)}"
            onchange="updateInv('${r.id}','cat',this.value); this.className='csel c'+catAbbr(this.value)"
            ${isLocked ? 'disabled' : ''}>${catOpts}</select>
        </td>
        <td>
          <textarea class="cedit" rows="1" oninput="ar(this)"
            onchange="updateInv('${r.id}','name',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${r.id}')">${r.name || ''}</textarea>
        </td>
        <td class="tdq">
          <input type="number" class="qinput" value="${r.qty_sent || 0}"
            onchange="updateInv('${r.id}','qty_sent',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${r.id}')">
        </td>
        <td>
          <textarea class="cedit" rows="1" oninput="ar(this)"
            onchange="updateInv('${r.id}','notes',this.value)" ${isLocked ? 'disabled' : ''}
            onkeypress="handleRowKeypress(event,'${r.id}')">${r.notes || ''}</textarea>
        </td>
        <td class="tda">
          <div class="act-wrap">
            <button class="save-row-btn" style="display:${!isLocked ? 'inline-flex' : 'none'}"
              onclick="lockRow('${r.id}')">âœ“ Ø­ÙØ¸</button>
            <button class="act-btn" onclick="toggleMenu(this)" style="display:${isLocked ? 'inline-block' : 'none'}">â‹®</button>
            <div class="act-menu">
              <button onclick="unlockRow('${r.id}');closeAllMenus()">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="danger" onclick="delInvRow('${r.id}');closeAllMenus()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </div>
          </div>
        </td>`;
      tbody.appendChild(tr);
    });

    tbody.querySelectorAll('textarea').forEach(ar);
  }

  async function updateInv(id, field, val) {
    const row = inventory.find(x => x.id === id);
    if (row) row[field] = val;
    await db.from('inventory').update({ [field]: val }).eq('id', id);
  }

  async function addInvRow() {
    ld();
    const id = 'i' + Date.now();
    newRowId = id;
    await db.from('inventory').insert({
      id, cat: 'components', name: '', notes: '',
      qty_sent: 0, qty_actual: 0
    });
    await loadInventory();
    uh();
    const newRow = document.getElementById('row-' + id);
    if (newRow) {
      newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      const firstInput = newRow.querySelector('select, textarea');
      if (firstInput) firstInput.focus();
    }
  }

  async function delInvRow(id) {
    if (!confirm('ØªØ­Ø°Ù Ø§Ù„ØµÙ†ÙØŸ')) return;
    ld();
    await db.from('inventory').delete().eq('id', id);
    inventory = inventory.filter(x => x.id !== id);
    delete rowEditStates[id];
    renderInventory();
    uh();
  }


  /* ==============================================================
     13. TECH DAY â€” ØµÙØ­Ø§Øª Tech Day (Prep / Recv / Check)
     ==============================================================*/

  /* Ø±Ø¨Ø· ÙƒÙ„ Ù†ÙˆØ¹ Ø¨Ù€ id Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ ÙÙŠ HTML */
  const tdTables = {
    prep:  'tdprep-body',
    recv:  'tdrecv-body',
    check: 'tdcheck-body',
  };

  /* ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø­Ø¯ Ø£Ù†ÙˆØ§Ø¹ TechDay */
  async function loadTD(type) {
    ld();
    const { data } = await db.from('techday_' + type).select('*').order('sort_order');
    if      (type === 'prep')  tdPrep  = data || [];
    else if (type === 'recv')  tdRecv  = data || [];
    else                       tdCheck = data || [];
    rowEditStates = {};
    renderTD(type);
    uh();
  }

  /* Ø±Ø³Ù… Ø¬Ø¯ÙˆÙ„ TechDay Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ â€” ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ locked Ø¥Ù„Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
  function renderTD(type) {
    const tbody = document.getElementById(tdTables[type]);
    tbody.innerHTML = '';
    const rows = type === 'prep' ? tdPrep : type === 'recv' ? tdRecv : tdCheck;

    rows.forEach((row, i) => {
      const isLocked = row.id !== newRowId;
      const tr = document.createElement('tr');
      tr.id        = 'row-' + row.id;
      tr.className = isLocked ? 'row-locked' : '';

      /* Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ â€” Save Ù„Ù„Ø¬Ø¯ÙŠØ¯ØŒ â‹® Ù„Ù„Ù…ÙˆØ¬ÙˆØ¯ */
      const actCell = `
        <td class="tda">
          <div class="act-wrap">
            <button class="save-row-btn" style="display:${!isLocked ? 'inline-flex' : 'none'}"
              onclick="lockRow('${row.id}')">âœ“ Ø­ÙØ¸</button>
            <button class="act-btn" onclick="toggleMenu(this)" style="display:${isLocked ? 'inline-block' : 'none'}">â‹®</button>
            <div class="act-menu">
              <button onclick="unlockRow('${row.id}');closeAllMenus()">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="danger" onclick="delTD('${type}','${row.id}',${i});closeAllMenus()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </div>
          </div>
        </td>`;

      if (type === 'prep') {
        /* â”€â”€ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±: Ø±Ù‚Ù… + Ù…Ù‡Ù…Ø© + ØªÙØ§ØµÙŠÙ„ â”€â”€ */
        tr.innerHTML = `
          <td style="text-align:center;vertical-align:middle;padding:9px 5px">
            <span style="display:inline-flex;width:26px;height:26px;border-radius:7px;align-items:center;justify-content:center;font-size:11px;font-weight:800;background:#f3f4f6;color:var(--g600)">${i + 1}</span>
          </td>
          <td>
            <textarea class="cedit" style="font-weight:700" rows="1" oninput="ar(this)"
              onchange="updateTD('prep','${row.id}','name',this.value)" ${isLocked ? 'disabled' : ''}
              onkeypress="handleRowKeypress(event,'${row.id}')">${row.name || ''}</textarea>
          </td>
          <td>
            <textarea class="cedit" style="color:var(--g600);font-size:12px" rows="1" oninput="ar(this)"
              onchange="updateTD('prep','${row.id}','detail',this.value)" ${isLocked ? 'disabled' : ''}
              onkeypress="handleRowKeypress(event,'${row.id}')">${row.detail || ''}</textarea>
          </td>
          ${actCell}`;

      } else if (type === 'recv') {
        /* â”€â”€ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª: ØµÙ†Ù + Ù…Ø§Ø¯Ø© + Ø¹Ø¯Ø¯ + Ø­Ø§Ù„Ø© â”€â”€ */
        const catOpts  = ['components','machines','kits','materials']
          .map(c => `<option value="${c}" ${c === row.cat ? 'selected' : ''}>${catLabel(c)}</option>`).join('');
        const statOpts = ['Ù„Ù… ÙŠÙØ³ØªÙ„Ù…','Ù…ÙƒØªÙ…Ù„','Ù†Ø§Ù‚Øµ','ØªØ§Ù„Ù']
          .map(s => `<option ${s === row.status ? 'selected' : ''}>${s}</option>`).join('');

        tr.innerHTML = `
          <td class="tdc">
            <select class="csel c${catAbbr(row.cat || 'components')}"
              onchange="updateTD('recv','${row.id}','cat',this.value); this.className='csel c'+catAbbr(this.value)"
              ${isLocked ? 'disabled' : ''}>${catOpts}</select>
          </td>
          <td>
            <textarea class="cedit" rows="1" oninput="ar(this)"
              onchange="updateTD('recv','${row.id}','item',this.value)" ${isLocked ? 'disabled' : ''}
              onkeypress="handleRowKeypress(event,'${row.id}')">${row.item || ''}</textarea>
          </td>
          <td class="tdq">
            <div class="qctr">
              <button onclick="changeQty('tdrecv',${i},-1)" ${isLocked ? 'disabled' : ''}>âˆ’</button>
              <span id="qty-tdrecv-${i}">${row.qty || 0}</span>
              <button onclick="changeQty('tdrecv',${i},1)"  ${isLocked ? 'disabled' : ''}>+</button>
            </div>
          </td>
          <td>
            <select class="isel" onchange="updateTD('recv','${row.id}','status',this.value)" ${isLocked ? 'disabled' : ''}>${statOpts}</select>
          </td>
          ${actCell}`;

      } else {
        /* â”€â”€ Check List: checkbox + ØµÙ†Ù + Ø§Ø³Ù… + Ø¹Ø¯Ø¯ + Ù…Ù„Ø§Ø­Ø¸Ø§Øª + ØªØ§Ø±ÙŠØ® â”€â”€ */
        const catOpts = ['components','machines','kits','materials']
          .map(c => `<option value="${c}" ${c === row.cat ? 'selected' : ''}>${catLabel(c)}</option>`).join('');

        tr.innerHTML = `
          <td style="text-align:center;vertical-align:middle;padding:9px 5px">
            <input type="checkbox" ${row.done ? 'checked' : ''}
              onchange="updateTD('check','${row.id}','done',this.checked)">
          </td>
          <td class="tdc">
            <select class="csel c${catAbbr(row.cat || 'components')}"
              onchange="updateTD('check','${row.id}','cat',this.value); this.className='csel c'+catAbbr(this.value)"
              ${isLocked ? 'disabled' : ''}>${catOpts}</select>
          </td>
          <td>
            <textarea class="cedit" rows="1" oninput="ar(this)"
              onchange="updateTD('check','${row.id}','name',this.value)" ${isLocked ? 'disabled' : ''}
              onkeypress="handleRowKeypress(event,'${row.id}')">${row.name || ''}</textarea>
          </td>
          <td class="tdq">
            <div class="qctr">
              <button onclick="changeQtyCheck(${i},-1)" ${isLocked ? 'disabled' : ''}>âˆ’</button>
              <span id="qty-chk-${i}">${row.qty || 0}</span>
              <button onclick="changeQtyCheck(${i},1)"  ${isLocked ? 'disabled' : ''}>+</button>
            </div>
          </td>
          <td>
            <textarea class="cedit" rows="1" oninput="ar(this)"
              onchange="updateTD('check','${row.id}','note',this.value)" ${isLocked ? 'disabled' : ''}
              onkeypress="handleRowKeypress(event,'${row.id}')">${row.note || ''}</textarea>
          </td>
          <td>
            <input type="date" class="cedit" value="${row.delivery_date || ''}"
              onchange="updateTD('check','${row.id}','delivery_date',this.value)" ${isLocked ? 'disabled' : ''}>
          </td>
          ${actCell}`;
      }

      tbody.appendChild(tr);
    });

    tbody.querySelectorAll('textarea').forEach(ar);
  }

  /* ØªØ­Ø¯ÙŠØ« Ø­Ù‚Ù„ ÙÙŠ TechDay */
  async function updateTD(type, id, field, val) {
    await db.from('techday_' + type).update({ [field]: val }).eq('id', id);
  }

  /* Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯ ÙÙŠ TechDay */
  async function addTDRow(type) {
    ld();
    const id   = 'td' + Date.now();
    newRowId   = id;  // Ù†ÙØªØ­ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù…Ø¨Ø§Ø´Ø±Ø©
    const base = { id, sort_order: (type === 'prep' ? tdPrep : type === 'recv' ? tdRecv : tdCheck).length };

    if      (type === 'prep')  await db.from('techday_prep').insert({ ...base, name: '', detail: '' });
    else if (type === 'recv')  await db.from('techday_recv').insert({ ...base, cat: 'components', item: '', qty: 0, status: 'Ù„Ù… ÙŠÙØ³ØªÙ„Ù…' });
    else                       await db.from('techday_check').insert({ ...base, cat: 'components', name: '', note: '', done: false, qty: 0 });

    await loadTD(type);
    uh();
    const newRow = document.getElementById('row-' + id);
    if (newRow) {
      newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      const firstInput = newRow.querySelector('textarea, select');
      if (firstInput) firstInput.focus();
    }
  }

  /* Ø­Ø°Ù ØµÙ Ù…Ù† TechDay */
  async function delTD(type, id, i) {
    if (!confirm('ØªØ­Ø°ÙØŸ')) return;
    ld();
    await db.from('techday_' + type).delete().eq('id', id);
    await loadTD(type);
    uh();
  }


  /* ==============================================================
     14. AUDIT â€” Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ
     ================================================================
     Ø¨ÙŠØ¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ù…Ø¹ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ø´Ù‡Ø± Ø§Ù„Ø®Ø§ØµÙŠÙ† Ø¨ÙƒÙ„ Ø«ÙŠÙ…
     Ù…Ù† Ø¬Ø¯ÙˆÙ„ theme_dates ÙˆÙŠØ¹Ø±Ø¶Ù‡Ù… ÙÙŠ Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø­Ø¯ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙÙ„ØªØ±Ø©
     ==============================================================*/

  async function loadAudit() {
    ld();
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ø¶ Ø£Ø³Ù…Ø§Ø¦Ù‡Ù… ÙÙŠ Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    const { data: sc } = await db.from('schools').select('*').order('name');
    schools = sc || [];
    renderAuditSchoolChips();
    await renderAudit();
    uh();
  }

  /* Ø±Ø³Ù… ØªØ´ÙŠØ¨Ø³ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¬Ø±Ø¯ */
  function renderAuditSchoolChips() {
    const cont = document.getElementById('audit-school-chips');
    cont.innerHTML = '';
    schools.forEach(s => {
      const btn = document.createElement('button');
      btn.className = 'chip' + (auditSelectedSchools.has(s.id) ? ' active' : '');
      btn.textContent = (s.icon || 'ğŸ«') + ' ' + s.name;
      btn.onclick = () => {
        if (auditSelectedSchools.has(s.id)) auditSelectedSchools.delete(s.id);
        else auditSelectedSchools.add(s.id);
        renderAuditSchoolChips();
        renderAudit();
      };
      cont.appendChild(btn);
    });
  }

  /* Ø±Ø³Ù… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø±Ø¯ â€” Ø¨Ø¯ÙˆÙ† Ø£Ø¹Ù…Ø¯Ø© Ù…Ø¯Ø±Ø³Ø©/Ø³Ù†Ø©/Ø´Ù‡Ø±ØŒ Ù…Ø¹ â‹® Ù„Ù„ÙØ¹Ù„ÙŠØ© ÙÙ‚Ø· */
  async function renderAudit() {
    const tbody = document.getElementById('audit-body');
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:20px;color:var(--g400)">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';

    const filterYear  = document.getElementById('audit-year')?.value  || '';
    const filterMonth = document.getElementById('audit-month')?.value || '';

    // Ø¬Ù„Ø¨ theme_dates Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙÙ„Ø§ØªØ±
    let datesQuery = db.from('theme_dates').select('*');
    if (filterYear)  datesQuery = datesQuery.eq('year',  filterYear);
    if (filterMonth) datesQuery = datesQuery.eq('month', filterMonth);
    const { data: dates } = await datesQuery;
    const datesList = dates || [];

    // Ø¬Ù„Ø¨ Ø§Ù„Ø«ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
    let rows = [];
    const buildRows = async (schoolFilter) => {
      let q = db.from('school_themes').select('*');
      if (schoolFilter.length) q = q.in('school_id', schoolFilter);
      const { data: themes } = await q.order('school_id').order('theme_index').order('sort_order');
      return (themes || []).map(t => {
        const d = datesList.find(x => x.school_id === t.school_id && x.theme_index === t.theme_index);
        if ((filterYear || filterMonth) && !d) return null;
        return { ...t };
      }).filter(Boolean);
    };

    const schoolFilter = auditSelectedSchools.size > 0
      ? [...auditSelectedSchools]
      : (datesList.length > 0 ? [...new Set(datesList.map(d => d.school_id))] : []);

    if (!filterYear && !filterMonth && auditSelectedSchools.size === 0) {
      // Ø¨Ø¯ÙˆÙ† ÙÙ„Ø§ØªØ± â†’ ÙƒÙ„ Ø§Ù„Ø«ÙŠÙ…Ø§Øª
      const { data: all } = await db.from('school_themes').select('*').order('school_id').order('theme_index').order('sort_order');
      rows = all || [];
    } else {
      rows = await buildRows(schoolFilter);
    }

    tbody.innerHTML = '';

    if (!rows.length) {
      tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:28px;color:var(--g400)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>';
      return;
    }

    rows.forEach(r => {
      const dmg      = Math.max(0, (parseInt(r.qty_sent) || 0) - (parseInt(r.qty_actual) || 0));
      const isLocked = r.id !== newRowId;
      const tr       = document.createElement('tr');
      tr.id          = 'row-audit-' + r.id;
      tr.innerHTML   = `
        <td class="tdc">
          <span style="padding:3px 9px;border-radius:14px;font-size:11px;font-weight:700;background:${catBg(r.cat)};color:${catClr(r.cat)}">${catLabel(r.cat)}</span>
        </td>
        <td style="padding:9px 13px">${r.item || '-'}</td>
        <td class="tdq" style="font-weight:700">${r.qty_sent || 0}</td>
        <td class="tdq" style="font-weight:800;color:var(--or)">
          ${isLocked
            ? (r.qty_actual || 0)
            : `<input type="number" class="qinput" value="${r.qty_actual || 0}"
                onchange="updateThemeActual('${r.id}',this.value)"
                onkeypress="if(event.key==='Enter'){event.preventDefault();lockAuditRow('${r.id}')}">`
          }
        </td>
        <td class="tdq" style="color:${dmg > 0 ? '#ef4444' : '#10b981'};font-weight:700">${dmg}</td>
        <td>
          <textarea class="cedit" rows="1" oninput="ar(this)"
            onchange="updateThemeNote('${r.id}',this.value)"
            ${isLocked ? 'disabled' : ''}
            onkeypress="handleAuditKeypress(event,'${r.id}')">${r.note || ''}</textarea>
        </td>
        <td class="tda">
          <div class="act-wrap">
            <button class="save-row-btn" style="display:${!isLocked ? 'inline-flex' : 'none'}"
              onclick="lockAuditRow('${r.id}');renderAudit()">âœ“ Ø­ÙØ¸</button>
            <button class="act-btn" onclick="toggleMenu(this)" style="display:${isLocked ? 'inline-block' : 'none'}">â‹®</button>
            <div class="act-menu">
              <button onclick="unlockAuditRow('${r.id}')">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠØ©</button>
            </div>
          </div>
        </td>`;
      tbody.appendChild(tr);
    });

    tbody.querySelectorAll('textarea').forEach(ar);
  }

  /* ÙØªØ­ ØµÙ ÙÙŠ Ø§Ù„Ø¬Ø±Ø¯ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ */
  function unlockAuditRow(id) {
    newRowId = id;
    closeAllMenus();
    renderAudit();
  }

  /* Ù‚ÙÙ„ ØµÙ Ø§Ù„Ø¬Ø±Ø¯ */
  function lockAuditRow(id) {
    if (newRowId === id) newRowId = null;
  }

  /* Enter ÙÙŠ ØµÙ Ø¬Ø±Ø¯ â†’ Ù‚ÙÙ„ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… */
  function handleAuditKeypress(event, id) {
    if (event.key === 'Enter') {
      event.preventDefault();
      lockAuditRow(id);
      renderAudit();
    }
  }

  /* Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ */
  async function addAuditRow() {
    ld();
    const id = 'au' + Date.now();
    newRowId  = id;
    // Ù†Ø¶ÙŠÙ ÙÙŠ school_themes Ù…Ø±ØªØ¨Ø· Ø¨Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© (Ø£ÙˆÙ„ Ù…Ø¯Ø±Ø³Ø© Ù„Ùˆ Ù…ÙÙŠØ´ ÙÙ„ØªØ±)
    const schoolId = auditSelectedSchools.size > 0
      ? [...auditSelectedSchools][0]
      : (schools[0]?.id || null);
    if (!schoolId) { alert('Ø§Ø®ØªØ§Ø± Ù…Ø¯Ø±Ø³Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ø§Ù„ÙÙ„Ø§ØªØ±'); uh(); return; }
    await db.from('school_themes').insert({
      id, school_id: schoolId, theme_index: 0,
      cat: 'components', item: '', qty: 0, qty_actual: 0, note: '',
      sort_order: 9999
    });
    await renderAudit();
    uh();
    const newRow = document.getElementById('row-audit-' + id);
    if (newRow) {
      newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  }

  /* ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù„Ù„Ø«ÙŠÙ… (qty_actual) ÙÙŠ Ø§Ù„Ø¬Ø±Ø¯ */
  async function updateThemeActual(id, val) {
    await db.from('school_themes').update({ qty_actual: parseInt(val) || 0 }).eq('id', id);
  }

  /* ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø«ÙŠÙ… ÙÙŠ Ø§Ù„Ø¬Ø±Ø¯ */
  async function updateThemeNote(id, val) {
    await db.from('school_themes').update({ note: val }).eq('id', id);
  }


  /* ==============================================================
     15. ROW LOCKING â€” Ù†Ø¸Ø§Ù… Ù‚ÙÙ„/ÙØªØ­ Ø§Ù„ØµÙÙˆÙ
     ================================================================
     Ø§Ù„Ù…Ù†Ø·Ù‚:
     â€¢ ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ØªØ¨Ø¯Ø£ LOCKED (read-only)
     â€¢ Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙŠØªÙØªØ­ UNLOCKED Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„
     â€¢ Ù„Ù…Ø§ ØªØ¶ØºØ· Enter Ø£Ùˆ ØªØ¶ØºØ· Save â†’ Ø§Ù„ØµÙ ÙŠØªÙ‚ÙÙ„
     â€¢ Ù„Ù…Ø§ ØªØ¶ØºØ· â‹® Ø«Ù… "ØªØ¹Ø¯ÙŠÙ„" â†’ Ø§Ù„ØµÙ ÙŠØªÙØªØ­ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
     ==============================================================*/

  /* id Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙŠ Ù„Ø³Ù‡ Ù…Ø´ Ø§ØªØ­ÙØ¸/Ø§ØªÙ‚ÙÙ„ */
  let newRowId = null;

  /* Ù‚ÙÙ„ ØµÙ â†’ ØªØ¹Ø·ÙŠÙ„ ÙƒÙ„ Ø­Ù‚ÙˆÙ„Ù‡ */
  function lockRow(rowId) {
    rowEditStates[rowId] = true;
    if (rowId === newRowId) newRowId = null;
    const row = document.getElementById('row-' + rowId);
    if (row) {
      row.classList.add('row-locked');
      row.querySelectorAll('input:not([type=checkbox]), select, textarea').forEach(el => {
        el.disabled = true;
      });
      // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø±Ø§Ø± Save â†’ Ø¥Ø®ÙØ§Ø¡Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„Ù‚ÙÙ„
      const saveBtn = row.querySelector('.save-row-btn');
      if (saveBtn) saveBtn.style.display = 'none';
    }
  }

  /* ÙØªØ­ ØµÙ â†’ ØªÙØ¹ÙŠÙ„ Ø­Ù‚ÙˆÙ„Ù‡ ÙˆØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ø­Ù‚Ù„ */
  function unlockRow(rowId) {
    // Ù„Ùˆ ÙÙŠ ØµÙ Ø¬Ø¯ÙŠØ¯ Ù…ÙØªÙˆØ­ â†’ Ø§Ù‚ÙÙ„Ù‡ Ø£ÙˆÙ„Ø§Ù‹
    if (newRowId && newRowId !== rowId) lockRow(newRowId);
    // Ù„Ùˆ ÙÙŠ ØµÙ ØªØ¹Ø¯ÙŠÙ„ Ù…ÙØªÙˆØ­ Ø¢Ø®Ø± â†’ Ø§Ù‚ÙÙ„Ù‡
    Object.keys(rowEditStates).forEach(id => {
      if (id !== rowId && !rowEditStates[id]) lockRow(id);
    });

    delete rowEditStates[rowId];
    const row = document.getElementById('row-' + rowId);
    if (row) {
      row.classList.remove('row-locked');
      row.querySelectorAll('input:not([type=checkbox]), select, textarea').forEach(el => {
        el.disabled = false;
      });
      const firstInput = row.querySelector('select.isel, textarea, input:not([type=checkbox]):not([disabled])');
      if (firstInput) firstInput.focus();
    }
  }

  /* ÙØªØ­ ØµÙ Ø¬Ø¯ÙŠØ¯ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© */
  function unlockNewRow(rowId) {
    newRowId = rowId;
    delete rowEditStates[rowId];
    const row = document.getElementById('row-' + rowId);
    if (row) {
      row.classList.remove('row-locked');
      row.querySelectorAll('input:not([type=checkbox]), select, textarea').forEach(el => {
        el.disabled = false;
      });
      // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø±Ø§Ø± Save
      const saveBtn = row.querySelector('.save-row-btn');
      if (saveBtn) saveBtn.style.display = 'inline-flex';
      // ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„
      const firstInput = row.querySelector('select.isel, textarea, input:not([type=checkbox]):not([disabled])');
      if (firstInput) firstInput.focus();
    }
  }

  /* Enter Ø¯Ø§Ø®Ù„ ØµÙ â†’ Ø§Ù‚ÙÙ„Ù‡ */
  function handleRowKeypress(event, rowId) {
    if (event.key === 'Enter') {
      event.preventDefault();
      lockRow(rowId);
    }
  }


  /* ==============================================================
     16. QTY CHANGE â€” ØªØºÙŠÙŠØ± Ø§Ù„ÙƒÙ…ÙŠØ§Øª (+ / âˆ’)
     ==============================================================*/

  /* ØªØºÙŠÙŠØ± ÙƒÙ…ÙŠØ© ÙÙŠ theme / ret / tdrecv */
  async function changeQty(type, i, delta) {
    let row, tbl;
    if      (type === 'theme')  { row = themeRows[i];  tbl = 'school_themes'; }
    else if (type === 'ret')    { row = returnRows[i];  tbl = 'school_returns'; }
    else if (type === 'tdrecv') { row = tdRecv[i];      tbl = 'techday_recv'; }
    if (!row) return;

    const newQty = Math.max(0, (parseInt(row.qty) || 0) + delta);
    row.qty = newQty;
    const span = document.getElementById(`qty-${type}-${i}`);
    if (span) span.textContent = newQty;
    await db.from(tbl).update({ qty: newQty }).eq('id', row.id);
  }

  /* ØªØºÙŠÙŠØ± ÙƒÙ…ÙŠØ© ÙÙŠ Check List */
  async function changeQtyCheck(i, delta) {
    const row = tdCheck[i];
    if (!row) return;
    const newQty = Math.max(0, (parseInt(row.qty) || 0) + delta);
    row.qty = newQty;
    const span = document.getElementById(`qty-chk-${i}`);
    if (span) span.textContent = newQty;
    await db.from('techday_check').update({ qty: newQty }).eq('id', row.id);
  }


  /* ==============================================================
     17. ACTION MENU â€” Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ 3 Ù†Ù‚Ø§Ø·
     ==============================================================*/

  /* ÙØªØ­/ØºÙ„Ù‚ Ù‚Ø§Ø¦Ù…Ø© ØµÙ Ù…Ø¹ÙŠÙ† */
  function toggleMenu(btn) {
    const menu   = btn.nextElementSibling;
    const isOpen = menu.classList.contains('open');
    closeAllMenus();
    if (!isOpen) menu.classList.add('open');
  }

  /* ØºÙ„Ù‚ ÙƒÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…ÙØªÙˆØ­Ø© */
  function closeAllMenus() {
    document.querySelectorAll('.act-menu.open').forEach(m => m.classList.remove('open'));
  }

  /* Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¶ØºØ· Ø¨Ø±Ù‘Ø§ Ø£ÙŠ Ù‚Ø§Ø¦Ù…Ø© â†’ Ø£ØºÙ„Ù‚Ù‡Ø§ */
  document.addEventListener('click', e => {
    if (!e.target.closest('.act-wrap')) closeAllMenus();
  });


  /* ==============================================================
     18. UTILITY FUNCTIONS â€” Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
     ==============================================================*/

  /* ØªØ±Ø¬Ù…Ø© ÙƒÙˆØ¯ Ø§Ù„ÙØ¦Ø© Ù„Ø§Ø³Ù… Ø¹Ø±Ø¨ÙŠ */
  function catLabel(c) {
    return { components: 'Components', machines: 'Machines', kits: 'Kits', materials: 'Materials' }[c] || c;
  }

  /* Ø§Ø®ØªØµØ§Ø± Ø§Ù„ÙØ¦Ø© (Ù„Ù„Ù€ CSS class) */
  function catAbbr(c) {
    return { components: 'c', machines: 'm', kits: 'k', materials: 'mt' }[c] || 'c';
  }

  /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© Ø§Ù„ÙØ¦Ø© */
  function catBg(c) {
    return { components: '#EFF6FF', machines: '#F0FDF4', kits: '#FFF7ED', materials: '#FAF5FF' }[c] || '#f3f4f6';
  }

  /* Ù„ÙˆÙ† Ù†Øµ Ø§Ù„ÙØ¦Ø© */
  function catClr(c) {
    return { components: '#2563EB', machines: '#16A34A', kits: '#EA580C', materials: '#9333EA' }[c] || '#374151';
  }

  /* Ø¶Ø¨Ø· Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù€ textarea ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
  function ar(el) {
    el.style.height = 'auto';
    el.style.height = el.scrollHeight + 'px';
  }


  /* ==============================================================
     19. INIT â€” ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
     ==============================================================*/

  async function init() {
    ld();
    // Ù†Ø­Ù…Ù‘Ù„ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ù…Ø¯Ø§Ø±Ø³ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¹Ø´Ø§Ù† ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª ØªØ­ØªØ§Ø¬Ù‡Ù…
    const { data: inv } = await db.from('inventory').select('*').order('cat').order('name');
    inventory = inv || [];
    const { data: sc }  = await db.from('schools').select('*').order('created_at');
    schools = sc || [];

    // Ù„Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ§Ø¶ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ â†’ Ù†Ø²Ø±Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
    if (schools.length === 0) await seedSchools();

    // Ù„Ùˆ Ø¬Ø¯ÙˆÙ„ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ± ÙØ§Ø¶ÙŠ â†’ Ù†Ø²Ø±Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    const { data: prepCheck } = await db.from('techday_prep').select('id').limit(1);
    if (!prepCheck || prepCheck.length === 0) await seedPrepSteps();

    uh();
    goTo('home'); // Ù†Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¯Ø§ÙŠÙ…Ø§Ù‹
  }

  /* ==============================================================
     20. SEED SCHOOLS â€” Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
     ================================================================
     Ø¨ØªØªØ´ØºÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ù„Ù…Ø§ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙƒÙˆÙ† ÙØ§Ø¶ÙŠØ©
     ==============================================================*/
  async function seedSchools() {
    const schoolsList = [
      { name: 'Uptown',         icon: 'ğŸ«' },
      { name: 'ACIC',           icon: 'ğŸ«' },
      { name: 'Sun of Glory',   icon: 'ğŸŒŸ' },
      { name: 'AL-Andalus',     icon: 'ğŸ«' },
      { name: 'Highland',       icon: 'â›°ï¸' },
      { name: 'Emerald',        icon: 'ğŸ’š' },
      { name: 'Moon Garden L1', icon: 'ğŸŒ™' },
      { name: 'Moon Garden L2', icon: 'ğŸŒ™' },
      { name: 'Green City',     icon: 'ğŸŒ¿' },
      { name: 'Smart Vision',   icon: 'ğŸ‘ï¸' },
      { name: 'Rajac L1',       icon: 'ğŸ«' },
      { name: 'City L1',        icon: 'ğŸ™ï¸' },
      { name: 'City L2',        icon: 'ğŸ™ï¸' },
      { name: 'QIS',            icon: 'ğŸ«' },
      { name: 'QAS',            icon: 'ğŸ«' },
      { name: 'EBIS',           icon: 'ğŸ«' },
      { name: 'Liberty',        icon: 'ğŸ—½' },
      { name: 'ASA',            icon: 'ğŸ«' },
      { name: 'AIS',            icon: 'ğŸ«' },
    ];

    const toInsert = schoolsList.map((s, i) => ({
      id:   's' + (Date.now() + i),
      name: s.name,
      icon: s.icon,
    }));

    const { error } = await db.from('schools').insert(toInsert);
    if (!error) {
      const { data: sc } = await db.from('schools').select('*').order('created_at');
      schools = sc || [];
    }
  }

  /* ==============================================================
     21. SEED PREP STEPS â€” Ø®Ø·ÙˆØ§Øª Ø®Ø·Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
     ================================================================
     Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ â€” Ø¨ØªØªØ¶Ø§Ù Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
     ==============================================================*/
  async function seedPrepSteps() {
    const steps = [
      {
        name:   'Ø§Ù„Ø®Ø·Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ',
        detail: 'Ø§Ø³ØªÙ„Ø§Ù… Ø®Ø·Ø§Ø¨ Ø±Ø³Ù…ÙŠ Ù…Ù† Ø§Ù„Ø¨Ø´Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø¸ÙŠÙ… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙŠØªØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.',
      },
      {
        name:   'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙŠØ´ØªØ±',
        detail: 'ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ´Ù†Ø² Ù…Ù† Ø®Ù„Ø§Ù„ Ø­Ø³Ø¨Ø© Ù†Ù‚ÙˆÙ… Ø¨Ù‡Ø§ Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„ÙƒÙ„ Ø§Ù„Ø§Ø³ØªÙŠØ´ØªØ± â€” Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø³Ø§Ø¹Ø© 8 ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø§Ø¹Ø© 2.',
      },
      {
        name:   'Ø§Ù„ÙƒÙŠØªØ§Øª (Kits)',
        detail: `ÙÙŠ Ø§Ù„Ø£ØºÙ„Ø¨ Ø¯ÙŠ Ø§Ù„ÙƒÙŠØªØ³ Ø§Ù„Ø£Ø´Ù‡Ø±:
â€¢ RC CAR (2 Control)
â€¢ Fight Car (2 Control)
â€¢ Buzz Wire
â€¢ Scream
â€¢ Smart Pad
â€¢ EarthQuake (Wax - Tongue - Shish Sticks)
â€¢ Solar Panel (Sun)
â€¢ Robotic Arm
â€¢ IN MOOV (Screen - Cable)
â€¢ R.O.V (5000 rent)
â€¢ Box Cubic (Screen)`,
      },
      {
        name:   'Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Machines)',
        detail: `â€¢ Ã—2 Ø·Ø§Ø¨Ø¹Ø© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (SD Card)
â€¢ Ã—1 Diode Laser + Laptop`,
      },
      {
        name:   'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Tests)',
        detail: 'Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ù„ÙŠØ³Øª Ø§Ù„ÙƒÙŠØªØ³ ÙˆØ§Ù„Ù…Ø§Ø´ÙŠÙ† ÙŠØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡Ø§ Ù„Ù‚Ø³Ù… Ø§Ù„Ø§Ù†ØªØ§Ø¬ Ù„Ø¹Ù…Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù‡Ø§ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ù‡Ø§ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø³Ù„ÙŠÙ… ØªÙ…Ø§Ù…Ø§Ù‹.',
      },
      {
        name:   'Ø§Ù„Ù…Ù„Ø­Ù‚Ø§Øª',
        detail: `1- ØªØ¬ÙŠØ² ÙƒØ±ØªÙˆÙ†Ø© Ø¨Ù‡Ø§ Ù…Ø´ØªØ±ÙƒØ§Øª (Ù…Ø«Ø§Ù„: 20 Ù…Ø´ØªØ±Ùƒ Ø£Ùˆ Ø£ÙƒØ«Ø±)
2- ØªØ¬ÙŠØ² Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ÙƒÙŠØªØ§Øª ÙˆØ§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø´Ø±ÙƒØ©
3- ØªØ¬ÙŠØ² Ø¨Ø¯Ø§Ø¦Ù„:
â€¢ Ù„Ø§ ÙŠÙ‚Ù„ Ù…Ù† 100 LED
â€¢ Ù„Ø§ ÙŠÙ‚Ù„ Ù…Ù† 100 Jumper (M-M) Ùˆ (M-F)
â€¢ Resistor 330 Ã— 100`,
      },
    ];

    const toInsert = steps.map((s, i) => ({
      id:         'prep' + (Date.now() + i),
      name:       s.name,
      detail:     s.detail,
      sort_order: i,
    }));

    await db.from('techday_prep').insert(toInsert);
  }

</script>
</body>
</html>
